# CVE-2023-31128

- Published: 2023-05-26T22:15:00

- Modified: 2023-05-28T02:28:00

NextCloud Cookbook is a recipe library app. Prior to commit a46d9855 on the `master` branch and commit 489bb744 on the `main-0.9.x` branch, the `pull-checks.yml` workflow is vulnerable to command injection attacks because of using an untrusted `github.head_ref` field. The `github.head_ref` value is an attacker-controlled value. Assigning the value to `zzz";echo${IFS}"hello";#` can lead to command injection. Since the permission is not restricted, the attacker has a write-access to the repository. This issue is fixed in commit a46d9855 on the `master` branch and commit 489bb744 on the `main-0.9.x` branch. There is no risk for the user of the app within the NextCloud server. This only affects the main repository and possible forks of it. Those who have forked the NextCloud Cookbook repository should make sure their forks are on the latest version to prevent code injection attacks and similar.

### CVSS Score: **null**

| authentication | complexity | vector |
| --- | --- | --- |
| undefined | undefined | undefined |

| confidentiality | integrity | availability |
| --- | --- | --- |
| undefined | undefined | undefined |

## References

* https://github.com/nextcloud/cookbook/commit/489bb744

* https://github.com/nextcloud/cookbook/blob/a14d6ffc4d45e1447556f68606129dfd6c1505cf/.github/workflows/pull-checks.yml#L67

* https://github.com/nextcloud/cookbook/commit/a46d98559e2c64292da9ffb06138cccc2e50ae1b

* https://github.com/nextcloud/cookbook/security/advisories/GHSA-c5pc-mf2f-xq8h

* https://securitylab.github.com/research/github-actions-untrusted-input/

<details>
<summary>About this repository</summary> 

  This repository is part of the project [Live Hack CVE](https://github.com/Live-Hack-CVE). Main website can be found [www.live-hack.org](https://www.live-hack.org) 
  
  Made by [Sn0wAlice](https://github.com/Sn0wAlice) for the people that care about security and need to have a feed of the latest CVEs. Hope you enjoy it, don't forget to star the repo and follow me on [Twitter](https://twitter.com/Sn0wAlice) and [Github](https://github.com/Sn0wAlice). And that is my [personnal website](https://www.alice-snow.me/)

  - [Home Page](https://github.com/Live-Hack-CVE)
  - [Framework](https://github.com/Live-Hack-CVE/cve-framework)
  - [CVE database](https://github.com/Live-Hack-CVE/full_database)
  - [Changelog](https://github.com/Live-Hack-CVE/Changelog)
</details>

## Brut File

* [CVE-2023-31128.json](https://raw.githubusercontent.com/Live-Hack-CVE/full_database/main/cves/2023/CVE-2023-31128.json)

