# CVE-2023-36456

- Published: 2023-07-06T19:15:00

- Modified: 2023-07-07T12:50:00

authentik is an open-source Identity Provider. Prior to versions 2023.4.3 and 2023.5.5, authentik does not verify the source of the X-Forwarded-For and X-Real-IP headers, both in the Python code and the go code. Only authentik setups that are directly accessible by users without a reverse proxy are susceptible to this. Possible spoofing of IP addresses in logs, downstream applications proxied by (built in) outpost, IP bypassing in custom flows if used.

This poses a possible security risk when someone has flows or policies that check the user's IP address, e.g. when they want to ignore the user's 2 factor authentication when the user is connected to the company network. A second security risk is that the IP addresses in the logfiles and user sessions are not reliable anymore. Anybody can spoof this address and one cannot verify that the user has logged in from the IP address that is in their account's log. A third risk is that this header is passed on to the proxied application behind an outpost. The application may do any kind of verification, logging, blocking or rate limiting based on the IP address, and this IP address can be overridden by anybody that want to.

Versions 2023.4.3 and 2023.5.5 contain a patch for this issue.


### CVSS Score: **null**

| authentication | complexity | vector |
| --- | --- | --- |
| undefined | undefined | undefined |

| confidentiality | integrity | availability |
| --- | --- | --- |
| undefined | undefined | undefined |

## References

* https://goauthentik.io/docs/releases/2023.4#fixed-in-202343

* https://github.com/goauthentik/authentik/commit/15026748d19d490eb2baf9a9566ead4f805f7dff

* https://github.com/goauthentik/authentik/security/advisories/GHSA-cmxp-jcw7-jjjv

* https://goauthentik.io/docs/releases/2023.5#fixed-in-202355

* https://github.com/goauthentik/authentik/commit/c07a48a3eccbd7b23026f72136d3392bbc6f795a

<details>
<summary>About this repository</summary> 

  This repository is part of the project [Live Hack CVE](https://github.com/Live-Hack-CVE). Main website can be found [www.live-hack.org](https://www.live-hack.org) 
  
  Made by [Sn0wAlice](https://github.com/Sn0wAlice) for the people that care about security and need to have a feed of the latest CVEs. Hope you enjoy it, don't forget to star the repo and follow me on [Twitter](https://twitter.com/Sn0wAlice) and [Github](https://github.com/Sn0wAlice). And that is my [personnal website](https://www.alice-snow.me/)

  - [Home Page](https://github.com/Live-Hack-CVE)
  - [Framework](https://github.com/Live-Hack-CVE/cve-framework)
  - [CVE database](https://github.com/Live-Hack-CVE/full_database)
  - [Changelog](https://github.com/Live-Hack-CVE/Changelog)
</details>

## Brut File

* [CVE-2023-36456.json](https://raw.githubusercontent.com/Live-Hack-CVE/full_database/main/cves/2023/CVE-2023-36456.json)

