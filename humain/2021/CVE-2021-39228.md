# CVE-2021-39228

- Published: 2021-09-17T14:15:00

- Modified: 2021-09-30T19:02:00

Tremor is an event processing system for unstructured data. A vulnerability exists between versions 0.7.2 and 0.11.6. This vulnerability is a memory safety Issue when using `patch` or `merge` on `state` and assign the result back to `state`. In this case, affected versions of Tremor and the tremor-script crate maintains references to memory that might have been freed already. And these memory regions can be accessed by retrieving the `state`, e.g. send it over TCP or HTTP. This requires the Tremor server (or any other program using tremor-script) to execute a tremor-script script that uses the mentioned language construct. The issue has been patched in version 0.11.6 by removing the optimization and always cloning the target expression of a Merge or Patch. If an upgrade is not possible, a possible workaround is to avoid the optimization by introducing a temporary variable and not immediately reassigning to `state`.

### CVSS Score: **7.5**

| authentication | complexity | vector |
| --- | --- | --- |
| NONE | LOW | NETWORK |

| confidentiality | integrity | availability |
| --- | --- | --- |
| PARTIAL | PARTIAL | PARTIAL |

## References

* https://github.com/tremor-rs/tremor-runtime/pull/1217

* https://github.com/tremor-rs/tremor-runtime/commit/1a2efcdbe68e5e7fd0a05836ac32d2cde78a0b2e

* https://github.com/tremor-rs/tremor-runtime/releases/tag/v0.11.6

* https://github.com/tremor-rs/tremor-runtime/security/advisories/GHSA-mc22-5q92-8v85

<details>
<summary>About this repository</summary> 

  This repository is part of the project [Live Hack CVE](https://github.com/Live-Hack-CVE). Main website can be found [www.live-hack.org](https://www.live-hack.org) 
  
  Made by [Sn0wAlice](https://github.com/Sn0wAlice) for the people that care about security and need to have a feed of the latest CVEs. Hope you enjoy it, don't forget to star the repo and follow me on [Twitter](https://twitter.com/Sn0wAlice) and [Github](https://github.com/Sn0wAlice). And that is my [personnal website](https://www.alice-snow.me/)

  - [Home Page](https://github.com/Live-Hack-CVE)
  - [Framework](https://github.com/Live-Hack-CVE/cve-framework)
  - [CVE database](https://github.com/Live-Hack-CVE/full_database)
  - [Changelog](https://github.com/Live-Hack-CVE/Changelog)
</details>

## Brut File

* [CVE-2021-39228.json](https://raw.githubusercontent.com/Live-Hack-CVE/full_database/main/cves/2021/CVE-2021-39228.json)

