# CVE-2021-43979

- Published: 2021-11-17T19:15:00

- Modified: 2022-07-12T17:42:00

** DISPUTED ** Styra Open Policy Agent (OPA) Gatekeeper through 3.7.0 mishandles concurrency, sometimes resulting in incorrect access control. The data replication mechanism allows policies to access the Kubernetes cluster state. During data replication, OPA/Gatekeeper does not wait for the replication to finish before processing a request, which might cause inconsistencies between the replicated resources in OPA/Gatekeeper and the resources actually present in the cluster. Inconsistency can later be reflected in a policy bypass. NOTE: the vendor disagrees that this is a vulnerability, because Kubernetes states are only eventually consistent.

### CVSS Score: **5**

| authentication | complexity | vector |
| --- | --- | --- |
| NONE | LOW | NETWORK |

| confidentiality | integrity | availability |
| --- | --- | --- |
| NONE | PARTIAL | NONE |

## References

* https://github.com/hkerma/opa-gatekeeper-concurrency-issue

* https://github.com/open-policy-agent/gatekeeper/releases

<details>
<summary>About this repository</summary> 

  This repository is part of the project [Live Hack CVE](https://github.com/Live-Hack-CVE). Main website can be found [www.live-hack.org](https://www.live-hack.org) 
  
  Made by [Sn0wAlice](https://github.com/Sn0wAlice) for the people that care about security and need to have a feed of the latest CVEs. Hope you enjoy it, don't forget to star the repo and follow me on [Twitter](https://twitter.com/Sn0wAlice) and [Github](https://github.com/Sn0wAlice). And that is my [personnal website](https://www.alice-snow.me/)

  - [Home Page](https://github.com/Live-Hack-CVE)
  - [Framework](https://github.com/Live-Hack-CVE/cve-framework)
  - [CVE database](https://github.com/Live-Hack-CVE/full_database)
  - [Changelog](https://github.com/Live-Hack-CVE/Changelog)
</details>

## Brut File

* [CVE-2021-43979.json](https://raw.githubusercontent.com/Live-Hack-CVE/full_database/main/cves/2021/CVE-2021-43979.json)

