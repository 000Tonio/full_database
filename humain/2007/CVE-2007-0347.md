# CVE-2007-0347

- Published: 2007-01-29T20:28:00

- Modified: 2018-10-16T16:32:00

The is_eow function in format.c in CVSTrac before 2.0.1 does not properly check for the "'" (quote) character, which allows remote authenticated users to execute limited SQL injection attacks and cause a denial of service (database error) via a ' character in certain messages, tickets, or Wiki entries. An SQL injection via this technique is somewhat limited as is_eow() bails on whitespace. So while one _can_ do an SQL injection, one is limited to SQL queries containing only characters which get past the function isspace(3). This effectively limits attacks to SQL commands like "VACUUM". The DoS vulnerability exists because the is_eow() function in "format.c" does NOT just check the FIRST character of the supplied string for an End-Of-Word terminating character, but instead iterates over string and this way can skip a single embedded quotation mark. The is_repository_file() function then in turn assumes that the filename string can never contain a single quotation mark and traps into a SQL escaping problem. Successful remote unauthenticated exploit requires that CVSTrac is explicitly configured to allow anonymous users to add tickets (it is not by default).

### CVSS Score: **4.3**

| authentication | complexity | vector |
| --- | --- | --- |
| NONE | MEDIUM | NETWORK |

| confidentiality | integrity | availability |
| --- | --- | --- |
| NONE | NONE | PARTIAL |

## References

* http://lists.grok.org.uk/pipermail/full-disclosure/2007-January/052058.html

* http://osvdb.org/31935

* http://secunia.com/advisories/23940

* http://securityreason.com/securityalert/2192

* http://www.cvstrac.org/cvstrac/chngview?cn=850

* http://www.cvstrac.org/cvstrac/tktview?tn=683

* http://www.openpkg.com/security/advisories/OpenPKG-SA-2007.008.html

* http://www.securityfocus.com/archive/1/458455/100/0/threaded

* http://www.securityfocus.com/bid/22296

* http://www.vupen.com/english/advisories/2007/0398

<details>
<summary>About this repository</summary> 

  This repository is part of the project [Live Hack CVE](https://github.com/Live-Hack-CVE). Main website can be found [www.live-hack.org](https://www.live-hack.org) 
  
  Made by [Sn0wAlice](https://github.com/Sn0wAlice) for the people that care about security and need to have a feed of the latest CVEs. Hope you enjoy it, don't forget to star the repo and follow me on [Twitter](https://twitter.com/Sn0wAlice) and [Github](https://github.com/Sn0wAlice). And that is my [personnal website](https://www.alice-snow.me/)

  - [Home Page](https://github.com/Live-Hack-CVE)
  - [Framework](https://github.com/Live-Hack-CVE/cve-framework)
  - [CVE database](https://github.com/Live-Hack-CVE/full_database)
  - [Changelog](https://github.com/Live-Hack-CVE/Changelog)
</details>

## Brut File

* [CVE-2007-0347.json](https://raw.githubusercontent.com/Live-Hack-CVE/full_database/main/cves/2007/CVE-2007-0347.json)

