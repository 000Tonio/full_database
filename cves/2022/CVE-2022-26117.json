{"Modified":"2023-02-16T19:28:00","Published":"2022-07-18T18:15:00","access":{},"assigner":"psirt@fortinet.com","capec":[{"id":"70","name":"Try Common or Default Usernames and Passwords","prerequisites":"The system uses one factor password based authentication.The adversary has the means to interact with the system.","related_weakness":["262","263","521","693","798"],"solutions":"Delete all default account credentials that may be put in by the product vendor. Implement a password throttling mechanism. This mechanism should take into account both the IP address and the log in name of the user. Put together a strong password policy and make sure that all user created passwords comply with it. Alternatively automatically generate strong passwords for users. Passwords need to be recycled to prevent aging, that is every once in a while a new password must be chosen.","summary":"An adversary may try certain common or default usernames and passwords to gain access into the system and perform unauthorized actions. An adversary may try an intelligent brute force using empty passwords, known vendor default credentials, as well as a dictionary of common usernames and passwords. Many vendor products come preconfigured with default (and thus well-known) usernames and passwords that should be deleted prior to usage in a production environment. It is a common mistake to forget to remove these default login credentials. Another problem is that users would pick very simple (common) passwords (e.g. \"secret\" or \"password\") that make it easier for the attacker to gain access to the system compared to using a brute force attack or even a dictionary attack using a full dictionary."},{"id":"112","name":"Brute Force","prerequisites":"The attacker must be able to determine when they have successfully guessed the secret. As such, one-time pads are immune to this type of attack since there is no way to determine when a guess is correct.","related_weakness":["326","330","521"],"solutions":"Select a provably large secret space for selection of the secret. Provably large means that the procedure by which the secret is selected does not have artifacts that significantly reduce the size of the total secret space. Do not provide the means for an attacker to determine success independently. This forces the attacker to check their guesses against an external authority, which can slow the attack and warn the defender. This mitigation may not be possible if testing material must appear externally, such as with a transmitted cryptotext.","summary":"In this attack, some asset (information, functionality, identity, etc.) is protected by a finite secret value. The attacker attempts to gain access to this asset by using trial-and-error to exhaustively explore all the possible secret values in the hope of finding the secret (or a value that is functionally equivalent) that will unlock the asset. Examples of secrets can include, but are not limited to, passwords, encryption keys, database lookup keys, and initial values to one-way functions. The key factor in this attack is the attackers' ability to explore the possible secret space rapidly. This, in turn, is a function of the size of the secret space and the computational power the attacker is able to bring to bear on the problem. If the attacker has modest resources and the secret space is large, the challenge facing the attacker is intractable. While the defender cannot control the resources available to an attacker, they can control the size of the secret space. Creating a large secret space involves selecting one's secret from as large a field of equally likely alternative secrets as possible and ensuring that an attacker is unable to reduce the size of this field using available clues or cryptanalysis. Doing this is more difficult than it sounds since elimination of patterns (which, in turn, would provide an attacker clues that would help them reduce the space of potential secrets) is difficult to do using deterministic machines, such as computers. Assuming a finite secret space, a brute force attack will eventually succeed. The defender must rely on making sure that the time and resources necessary to do so will exceed the value of the information. For example, a secret space that will likely take hundreds of years to explore is likely safe from raw-brute force attacks."},{"id":"49","name":"Password Brute Forcing","prerequisites":"An adversary needs to know a username to target. The system uses password based authentication as the one factor authentication mechanism. An application does not have a password throttling mechanism in place. A good password throttling mechanism will make it almost impossible computationally to brute force a password as it may either lock out the user after a certain number of incorrect attempts or introduce time out periods. Both of these would make a brute force attack impractical.","related_weakness":["257","262","263","521","693"],"solutions":"Implement a password throttling mechanism. This mechanism should take into account both the IP address and the log in name of the user. Put together a strong password policy and make sure that all user created passwords comply with it. Alternatively automatically generate strong passwords for users. Passwords need to be recycled to prevent aging, that is every once in a while a new password must be chosen.","summary":"In this attack, the adversary tries every possible value for a password until they succeed. A brute force attack, if feasible computationally, will always be successful because it will essentially go through all possible passwords given the alphabet used (lower case letters, upper case letters, numbers, symbols, etc.) and the maximum length of the password. A system will be particularly vulnerable to this type of an attack if it does not have a proper enforcement mechanism in place to ensure that passwords selected by users are strong passwords that comply with an adequate password policy. In practice a pure brute force attack on passwords is rarely used, unless the password is suspected to be weak. Other password cracking methods exist that are far more effective (e.g. dictionary attacks, rainbow tables, etc.). Knowing the password policy on the system can make a brute force attack more efficient. For instance, if the policy states that all passwords must be of a certain level, there is no need to check smaller candidates."},{"id":"55","name":"Rainbow Table Password Cracking","prerequisites":"Hash of the original password is available to the attacker. For a better chance of success, an attacker should have more than one hash of the original password, and ideally the whole table. Salt was not used to create the hash of the original password. Otherwise the rainbow tables have to be re-computed, which is very expensive and will make the attack effectively infeasible (especially if salt was added in iterations). The system uses one factor password based authentication.","related_weakness":["261","262","263","521","693","719","916"],"solutions":"Use salt when computing password hashes. That is, concatenate the salt (random bits) with the original password prior to hashing it.","summary":"An attacker gets access to the database table where hashes of passwords are stored. He then uses a rainbow table of pre-computed hash chains to attempt to look up the original password. Once the original password corresponding to the hash is obtained, the attacker uses the original password to gain access to the system. A password rainbow table stores hash chains for various passwords. A password chain is computed, starting from the original password, P, via a reduce(compression) function R and a hash function H. A recurrence relation exists where Xi+1 = R(H(Xi)), X0 = P. Then the hash chain of length n for the original password P can be formed: X1, X2, X3, ... , Xn-2, Xn-1, Xn, H(Xn). P and H(Xn) are then stored together in the rainbow table. Constructing the rainbow tables takes a very long time and is computationally expensive. A separate table needs to be constructed for the various hash algorithms (e.g. SHA1, MD5, etc.). However, once a rainbow table is computed, it can be very effective in cracking the passwords that have been hashed without the use of salt."},{"id":"16","name":"Dictionary-based Password Attack","prerequisites":"The system uses one factor password based authentication. The system does not have a sound password policy that is being enforced. The system does not implement an effective password throttling mechanism.","related_weakness":["262","263","521","693"],"solutions":"Create a strong password policy and ensure that your system enforces this policy. Implement an intelligent password throttling mechanism. Care must be taken to assure that these mechanisms do not excessively enable account lockout attacks such as CAPEC-02.","summary":"An attacker tries each of the words in a dictionary as passwords to gain access to the system via some user's account. If the password chosen by the user was a word within the dictionary, this attack will be successful (in the absence of other mitigations). This is a specific instance of the password brute forcing attack pattern."}],"cvss":null,"cwe":"CWE-521","id":"CVE-2022-26117","impact":{},"last-modified":"2023-02-16T19:28:00","references":["https://fortiguard.com/psirt/FG-IR-22-058","https://github.com/orangecertcc/security-research/security/advisories/GHSA-r259-5p5p-2q47"],"summary":"An empty password in configuration file vulnerability [CWE-258] in FortiNAC version 8.3.7 and below, 8.5.2 and below, 8.5.4, 8.6.0, 8.6.5 and below, 8.7.6 and below, 8.8.11 and below, 9.1.5 and below, 9.2.3 and below may allow an authenticated attacker to access the MySQL databases via the CLI.","vulnerable_configuration":[{"id":"cpe:2.3:a:fortinet:fortinac:8.5.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.5.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:8.5.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.5.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:8.5.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.5.2:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:8.5.4:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.5.4:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:8.8.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.8.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:8.8.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.8.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:8.8.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.8.2:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:8.8.3:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.8.3:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:8.8.4:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.8.4:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:8.8.5:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.8.5:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:8.8.6:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.8.6:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:8.8.7:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.8.7:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:8.8.8:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.8.8:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:8.7.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.7.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:8.7.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.7.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:8.7.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.7.2:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:8.7.3:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.7.3:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:8.6.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.6.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:8.6.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.6.2:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:8.6.3:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.6.3:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:8.6.4:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.6.4:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:8.6.5:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.6.5:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:8.3.7:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:8.3.7:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:9.1.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:9.1.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:9.1.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:9.1.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:9.1.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:9.1.2:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:fortinet:fortinac:9.2.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:fortinet:fortinac:9.2.0:*:*:*:*:*:*:*"}],"vulnerable_configuration_cpe_2_2":[],"vulnerable_product":["cpe:2.3:a:fortinet:fortinac:8.5.0:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:8.5.1:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:8.5.2:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:8.5.4:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:8.8.0:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:8.8.1:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:8.8.2:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:8.8.3:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:8.8.4:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:8.8.5:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:8.8.6:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:8.8.7:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:8.8.8:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:8.7.0:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:8.7.1:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:8.7.2:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:8.7.3:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:8.6.0:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:8.6.2:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:8.6.3:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:8.6.4:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:8.6.5:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:8.3.7:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:9.1.0:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:9.1.1:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:9.1.2:*:*:*:*:*:*:*","cpe:2.3:a:fortinet:fortinac:9.2.0:*:*:*:*:*:*:*"]}