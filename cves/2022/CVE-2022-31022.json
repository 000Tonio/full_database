{"Modified":"2022-06-09T14:13:00","Published":"2022-06-01T20:15:00","access":{"authentication":"NONE","complexity":"LOW","vector":"LOCAL"},"assigner":"security-advisories@github.com","capec":[{"id":"127","name":"Directory Indexing","prerequisites":"The target must be misconfigured to return a list of a directory's content when it receives a request that ends in a directory name rather than a file name. The adversary must be able to control the path that is requested of the target. The administrator must have failed to properly configure an ACL or has associated an overly permissive ACL with a particular directory. The server version or patch level must not inherently prevent known directory listing attacks from working.","related_weakness":["276","285","288","424","425","693","721","732"],"solutions":"1. Using blank index.html: putting blank index.html simply prevent directory listings from displaying to site visitors. 2. Preventing with .htaccess in Apache web server: In .htaccess, write \"Options-indexes\". 3. Suppressing error messages: using error 403 \"Forbidden\" message exactly like error 404 \"Not Found\" message.","summary":"An adversary crafts a request to a target that results in the target listing/indexing the content of a directory as output. One common method of triggering directory contents as output is to construct a request containing a path that terminates in a directory name rather than a file name since many applications are configured to provide a list of the directory's contents when such a request is received. An adversary can use this to explore the directory tree on a target as well as learn the names of files. This can often end up revealing test files, backup files, temporary files, hidden files, configuration files, user accounts, script contents, as well as naming conventions, all of which can be used by an attacker to mount additional attacks."}],"cvss":2.1,"cvss-time":"2022-06-09T14:13:00","cvss-vector":"AV:L/AC:L/Au:N/C:N/I:P/A:N","cwe":"CWE-288","id":"CVE-2022-31022","impact":{"availability":"NONE","confidentiality":"NONE","integrity":"PARTIAL"},"last-modified":"2022-06-09T14:13:00","references":["https://github.com/blevesearch/bleve/security/advisories/GHSA-9w9f-6mg8-jp7w","https://github.com/blevesearch/bleve/commit/1c7509d6a17d36f265c90b4e8f4e3a3182fe79ff"],"summary":"Bleve is a text indexing library for go. Bleve includes HTTP utilities under bleve/http package, that are used by its sample application. These HTTP methods pave way for exploitation of a node’s filesystem where the bleve index resides, if the user has used bleve’s own HTTP (bleve/http) handlers for exposing the access to the indexes. For instance, the CreateIndexHandler (`http/index_create.go`) and DeleteIndexHandler (`http/index_delete.go`) enable an attacker to create a bleve index (directory structure) anywhere where the user running the server has the write permissions and to delete recursively any directory owned by the same user account. Users who have used the bleve/http package for exposing access to bleve index without the explicit handling for the Role Based Access Controls(RBAC) of the index assets would be impacted by this issue. There is no patch for this issue because the http package is purely intended to be used for demonstration purposes. Bleve was never designed handle the RBACs, nor it was ever advertised to be used in that way. The collaborators of this project have decided to stay away from adding any authentication or authorization to bleve project at the moment. The bleve/http package is mainly for demonstration purposes and it lacks exhaustive validation of the user inputs as well as any authentication and authorization measures. It is recommended to not use bleve/http in production use cases.","vulnerable_configuration":[{"id":"cpe:2.3:a:couchbase:bleve:0.1.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:0.1.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:0.2.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:0.2.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:0.3.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:0.3.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:0.4.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:0.4.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:0.5.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:0.5.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:0.6.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:0.6.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:0.7.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:0.7.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:0.8.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:0.8.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:0.8.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:0.8.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:0.8.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:0.8.2:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:0.9.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:0.9.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:1.0.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:1.0.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:1.0.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:1.0.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:1.0.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:1.0.2:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:1.0.3:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:1.0.3:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:1.0.4:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:1.0.4:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:1.0.5:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:1.0.5:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:1.0.7:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:1.0.7:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:1.0.8:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:1.0.8:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:1.0.9:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:1.0.9:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:1.0.10:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:1.0.10:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:1.0.11:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:1.0.11:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:1.0.12:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:1.0.12:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:1.0.13:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:1.0.13:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:1.0.14:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:1.0.14:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:2.0.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:2.0.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:2.0.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:2.0.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:2.0.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:2.0.2:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:2.0.3:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:2.0.3:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:2.0.4:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:2.0.4:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:2.0.5:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:2.0.5:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:2.0.6:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:2.0.6:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:2.0.7:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:2.0.7:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:2.1.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:2.1.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:2.1.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:2.1.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:2.2.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:2.2.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:2.2.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:2.2.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:2.2.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:2.2.2:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:2.3.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:2.3.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:2.3.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:2.3.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:couchbase:bleve:2.3.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:couchbase:bleve:2.3.2:*:*:*:*:*:*:*"}],"vulnerable_configuration_cpe_2_2":[],"vulnerable_product":["cpe:2.3:a:couchbase:bleve:0.1.0:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:0.2.0:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:0.3.0:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:0.4.0:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:0.5.0:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:0.6.0:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:0.7.0:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:0.8.0:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:0.8.1:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:0.8.2:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:0.9.0:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:1.0.0:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:1.0.1:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:1.0.2:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:1.0.3:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:1.0.4:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:1.0.5:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:1.0.7:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:1.0.8:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:1.0.9:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:1.0.10:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:1.0.11:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:1.0.12:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:1.0.13:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:1.0.14:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:2.0.0:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:2.0.1:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:2.0.2:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:2.0.3:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:2.0.4:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:2.0.5:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:2.0.6:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:2.0.7:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:2.1.0:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:2.1.1:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:2.2.0:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:2.2.1:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:2.2.2:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:2.3.0:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:2.3.1:*:*:*:*:*:*:*","cpe:2.3:a:couchbase:bleve:2.3.2:*:*:*:*:*:*:*"]}