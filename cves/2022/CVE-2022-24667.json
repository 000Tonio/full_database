{"Modified":"2022-02-22T19:04:00","Published":"2022-02-09T23:15:00","access":{"authentication":"NONE","complexity":"LOW","vector":"NETWORK"},"assigner":"cve@forums.swift.org","capec":[{"id":"92","name":"Forced Integer Overflow","prerequisites":"The attacker can manipulate the value of an integer variable utilized by the target host. The target host does not do proper range checking on the variable before utilizing it. When the integer variable is incremented or decremented to an out of range value, it gets a very different value (e.g. very small or negative number)","related_weakness":["120","122","128","190","196","680","697"],"solutions":"Use a language or compiler that performs automatic bounds checking. Carefully review the service's implementation before making it available to user. For instance you can use manual or automated code review to uncover vulnerabilities such as integer overflow. Use an abstraction library to abstract away risky APIs. Not a complete solution. Always do bound checking before consuming user input data.","summary":"This attack forces an integer variable to go out of range. The integer variable is often used as an offset such as size of memory allocation or similarly. The attacker would typically control the value of such variable and try to get it out of range. For instance the integer in question is incremented past the maximum possible value, it may wrap to become a very small, or negative number, therefore providing a very incorrect value which can lead to unexpected behavior. At worst the attacker can execute arbitrary code."}],"cvss":5,"cvss-time":"2022-02-22T19:04:00","cvss-vector":"AV:N/AC:L/Au:N/C:N/I:N/A:P","cwe":"CWE-190","id":"CVE-2022-24667","impact":{"availability":"PARTIAL","confidentiality":"NONE","integrity":"NONE"},"last-modified":"2022-02-22T19:04:00","references":["https://github.com/apple/swift-nio-http2/security/advisories/GHSA-w3f6-pc54-gfw7"],"summary":"A program using swift-nio-http2 is vulnerable to a denial of service attack, caused by a network peer sending a specially crafted HPACK-encoded header block. This attack affects all swift-nio-http2 versions from 1.0.0 to 1.19.1. There are a number of implementation errors in the parsing of HPACK-encoded header blocks that allow maliciously crafted HPACK header blocks to cause crashes in processes using swift-nio-http2. Each of these crashes is triggered instead of an integer overflow. A malicious HPACK header block could be sent on any of the HPACK-carrying frames in a HTTP/2 connection (HEADERS and PUSH_PROMISE), at any position. Sending a HPACK header block does not require any special permission, so any HTTP/2 connection peer may send one. For clients, this means any server to which they connect may launch this attack. For servers, anyone they allow to connect to them may launch such an attack. The attack is low-effort: it takes very little resources to send an appropriately crafted field block. The impact on availability is high: receiving a frame carrying this field block immediately crashes the server, dropping all in-flight connections and causing the service to need to restart. It is straightforward for an attacker to repeatedly send appropriately crafted field blocks, so attackers require very few resources to achieve a substantial denial of service. The attack does not have any confidentiality or integrity risks in and of itself: swift-nio-http2 is parsing the field block in memory-safe code and the crash is triggered instead of an integer overflow. However, sudden process crashes can lead to violations of invariants in services, so it is possible that this attack can be used to trigger an error condition that has confidentiality or integrity risks. The risk can be mitigated if untrusted peers can be prevented from communicating with the service. This mitigation is not available to many services. The issue is fixed by rewriting the parsing code to correctly handle all conditions in the function. The principal issue was found by automated fuzzing by oss-fuzz, but several associated bugs in the same code were found by code audit and fixed at the same time","vulnerable_configuration":[{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.0.0:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.0.0:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.0.1:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.0.1:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.1.0:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.1.0:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.2.0:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.2.0:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.2.1:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.2.1:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.3.0:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.3.0:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.4.0:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.4.0:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.5.0:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.5.0:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.6.0:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.6.0:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.6.1:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.6.1:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.7.0:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.7.0:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.7.1:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.7.1:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.7.2:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.7.2:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.8.0:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.8.0:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.9.0:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.9.0:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.9.1:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.9.1:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.10.0:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.10.0:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.11.0:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.11.0:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.12.0:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.12.0:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.12.1:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.12.1:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.12.2:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.12.2:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.12.3:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.12.3:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.13.0:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.13.0:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.14.0:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.14.0:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.14.1:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.14.1:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.14.2:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.14.2:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.15.0:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.15.0:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.16.0:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.16.0:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.16.1:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.16.1:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.16.2:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.16.2:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.16.3:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.16.3:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.17.0:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.17.0:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.18.0:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.18.0:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.18.1:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.18.1:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.18.2:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.18.2:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.18.3:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.18.3:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.18.4:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.18.4:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.18.5:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.18.5:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.19.0:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.19.0:*:*:*:*:swift:*:*"},{"id":"cpe:2.3:a:apple:swiftnio_http\\/2:1.19.1:*:*:*:*:swift:*:*","title":"cpe:2.3:a:apple:swiftnio_http\\/2:1.19.1:*:*:*:*:swift:*:*"}],"vulnerable_configuration_cpe_2_2":[],"vulnerable_product":["cpe:2.3:a:apple:swiftnio_http\\/2:1.0.0:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.0.1:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.1.0:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.2.0:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.2.1:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.3.0:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.4.0:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.5.0:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.6.0:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.6.1:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.7.0:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.7.1:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.7.2:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.8.0:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.9.0:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.9.1:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.10.0:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.11.0:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.12.0:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.12.1:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.12.2:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.12.3:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.13.0:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.14.0:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.14.1:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.14.2:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.15.0:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.16.0:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.16.1:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.16.2:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.16.3:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.17.0:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.18.0:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.18.1:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.18.2:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.18.3:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.18.4:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.18.5:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.19.0:*:*:*:*:swift:*:*","cpe:2.3:a:apple:swiftnio_http\\/2:1.19.1:*:*:*:*:swift:*:*"]}