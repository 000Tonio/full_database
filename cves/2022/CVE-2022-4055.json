{"Modified":"2022-11-26T03:18:00","Published":"2022-11-19T00:15:00","access":{},"assigner":"secalert@redhat.com","capec":[{"id":"6","name":"Argument Injection","prerequisites":"Target software fails to strip all user-supplied input of any content that could cause the shell to perform unexpected actions. Software must allow for unvalidated or unfiltered input to be executed on operating system shell, and, optionally, the system configuration must allow for output to be sent back to client.","related_weakness":["146","184","185","697","713","74","78"],"solutions":"Design: Do not program input values directly on command shell, instead treat user input as guilty until proven innocent. Build a function that takes user input and converts it to applications specific types and values, stripping or filtering out all unauthorized commands and characters in the process. Design: Limit program privileges, so if metacharacters or other methods circumvent program input validation routines and shell access is attained then it is not running under a privileged account. chroot jails create a sandbox for the application to execute in, making it more difficult for an attacker to elevate privilege even in the case that a compromise has occurred. Implementation: Implement an audit log that is written to a separate host, in the event of a compromise the audit log may be able to provide evidence and details of the compromise.","summary":"An attacker changes the behavior or state of a targeted application through injecting data or command syntax through the targets use of non-validated and non-filtered arguments of exposed services or methods."},{"id":"15","name":"Command Delimiters","prerequisites":"Software's input validation or filtering must not detect and block presence of additional malicious command.","related_weakness":["138","140","146","154","157","184","185","697","713","77","78","93"],"solutions":"Design: Perform whitelist validation against a positive specification for command length, type, and parameters. Design: Limit program privileges, so if commands circumvent program input validation or filter routines then commands do not running under a privileged account Implementation: Perform input validation for all remote content. Implementation: Use type conversions such as JDBC prepared statements.","summary":"An attack of this type exploits a programs' vulnerabilities that allows an attacker's commands to be concatenated onto a legitimate command with the intent of targeting other resources such as the file system or database. The system that uses a filter or a blacklist input validation, as opposed to whitelist validation is vulnerable to an attacker who predicts delimiters (or combinations of delimiters) not present in the filter or blacklist. As with other injection attacks, the attacker uses the command delimiter payload as an entry point to tunnel through the application and activate additional attacks through SQL queries, shell commands, network scanning, and so on."}],"cvss":null,"cwe":"CWE-146","id":"CVE-2022-4055","impact":{},"last-modified":"2022-11-26T03:18:00","references":["https://gitlab.freedesktop.org/xdg/xdg-utils/-/issues/205#note_1494267"],"summary":"When xdg-mail is configured to use thunderbird for mailto URLs, improper parsing of the URL can lead to additional headers being passed to thunderbird that should not be included per RFC 2368. An attacker can use this method to create a mailto URL that looks safe to users, but will actually attach files when clicked.","vulnerable_configuration":[{"id":"cpe:2.3:a:freedesktop:xdg-utils:1.1.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:freedesktop:xdg-utils:1.1.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:freedesktop:xdg-utils:1.1.0:-:*:*:*:*:*:*","title":"cpe:2.3:a:freedesktop:xdg-utils:1.1.0:-:*:*:*:*:*:*"},{"id":"cpe:2.3:a:freedesktop:xdg-utils:1.1.0:rc1:*:*:*:*:*:*","title":"cpe:2.3:a:freedesktop:xdg-utils:1.1.0:rc1:*:*:*:*:*:*"},{"id":"cpe:2.3:a:freedesktop:xdg-utils:1.1.0:rc2:*:*:*:*:*:*","title":"cpe:2.3:a:freedesktop:xdg-utils:1.1.0:rc2:*:*:*:*:*:*"},{"id":"cpe:2.3:a:freedesktop:xdg-utils:1.1.0:rc3:*:*:*:*:*:*","title":"cpe:2.3:a:freedesktop:xdg-utils:1.1.0:rc3:*:*:*:*:*:*"},{"id":"cpe:2.3:a:freedesktop:xdg-utils:1.1.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:freedesktop:xdg-utils:1.1.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:freedesktop:xdg-utils:1.1.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:freedesktop:xdg-utils:1.1.2:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:freedesktop:xdg-utils:1.1.3:*:*:*:*:*:*:*","title":"cpe:2.3:a:freedesktop:xdg-utils:1.1.3:*:*:*:*:*:*:*"}],"vulnerable_configuration_cpe_2_2":[],"vulnerable_product":["cpe:2.3:a:freedesktop:xdg-utils:1.1.0:*:*:*:*:*:*:*","cpe:2.3:a:freedesktop:xdg-utils:1.1.0:-:*:*:*:*:*:*","cpe:2.3:a:freedesktop:xdg-utils:1.1.0:rc1:*:*:*:*:*:*","cpe:2.3:a:freedesktop:xdg-utils:1.1.0:rc2:*:*:*:*:*:*","cpe:2.3:a:freedesktop:xdg-utils:1.1.0:rc3:*:*:*:*:*:*","cpe:2.3:a:freedesktop:xdg-utils:1.1.1:*:*:*:*:*:*:*","cpe:2.3:a:freedesktop:xdg-utils:1.1.2:*:*:*:*:*:*:*","cpe:2.3:a:freedesktop:xdg-utils:1.1.3:*:*:*:*:*:*:*"]}