{"Modified":"2021-11-18T16:16:00","Published":"2020-10-16T17:15:00","access":{"authentication":"NONE","complexity":"HIGH","vector":"NETWORK"},"assigner":"security-advisories@github.com","capec":[{"id":"645","name":"Use of Captured Tickets (Pass The Ticket)","prerequisites":"The adversary needs physical access to the victim system. The use of a third-party credential harvesting tool.","related_weakness":["522"],"solutions":"Reset the built-in KRBTGT account password twice to invalidate the existence of any current Golden Tickets and any tickets derived from them. Monitor system and domain logs for abnormal access.","summary":"An adversary uses stolen Kerberos tickets to access systems that leverage the Kerberos authentication protocol. The Kerberos authentication protocol centers around a ticketing system which is used to request/grant access to services and to then access the requested services. An adversary can obtain any one of these tickets (e.g. Service Ticket, Ticket Granting Ticket, Silver Ticket, or Golden Ticket) to authenticate to a system without needing the account's credentials. Depending on the ticket obtained, the adversary may be able to access a particular resource or generate TGTs for any account within an Active Directory Domain."},{"id":"555","name":"Remote Services with Stolen Credentials","prerequisites":"","related_weakness":["522"],"solutions":"Disable RDP, telnet, SSH and enable firewall rules to block such traffic. Limit users and accounts that have remote interactive login access. Remove the Local Administrators group from the list of groups allowed to login through RDP. Limit remote user permissions. Use remote desktop gateways and multifactor authentication for remote logins.","summary":"This pattern of attack involves an adversary that uses stolen credentials to leverage remote services such as RDP, telnet, SSH, and VNC to log into a system. Once access is gained, any number of malicious activities could be performed."},{"id":"474","name":"Signature Spoofing by Key Theft","prerequisites":"An authoritative or reputable signer is storing their private signature key with insufficient protection.","related_weakness":["522"],"solutions":"Ensure all services are patched and up to date","summary":"An attacker obtains an authoritative or reputable signer's private signature key by theft and then uses this key to forge signatures from the original signer to mislead a victim into performing actions that benefit the attacker."},{"id":"644","name":"Use of Captured Hashes (Pass The Hash)","prerequisites":"The adversary needs to first obtain the hashed credentials of a user, via the use of a tool, prior to executing this attack. The victim system must allow Lan Man or NT Lan Man authentication.","related_weakness":["522"],"solutions":"Prevent the use of Lan Man and NT Lan Man authentication on severs and apply patch KB2871997 to Windows 7 and higher systems. Monitor system and domain logs for abnormal credential access. Leverage system penetration testing and other defense in depth methods to determine vulnerable systems within a domain.","summary":"An adversary uses stolen hash values for a user's credentials (username and password) to access systems managed under the same credential framwork that leverage the Lan Man (LM) and/or NT Lan Man (NTLM) authentication protocols. When authenticating via LM or NTLM, the hashed credentials' associated plaintext credentials are not requried for successful authentication. Therefore, if an adversary can obtain the hashed credentials of a user, he can then pass these hash values to the server or service to authenticate without needing to brute-force the hashes to obtain their cleartext values. The adversary can then impersonate the user and laterally move within the network. This technique can be performed against any operating system which leverages the LM or NTLM protocols."},{"id":"102","name":"Session Sidejacking","prerequisites":"An attacker and the victim are both using the same WiFi network. The victim has an active session with a target system. The victim is not using a secure channel to communicate with the target system (e.g. SSL, VPN, etc.) The victim initiated communication with a target system that requires transfer of the session token or the target application uses AJAX and thereby periodically \"rings home\" asynchronously using the session token","related_weakness":["294","319","522","523","614"],"solutions":"Make sure that HTTPS is used to communicate with the target system. Alternatively, use VPN if possible. It is important to ensure that all communication between the client and the server happens via an encrypted secure channel. Modify the session token with each transmission and protect it with cryptography. Add the idea of request sequencing that gives the server an ability to detect replay attacks.","summary":"Session sidejacking takes advantage of an unencrypted communication channel between a victim and target system. The attacker sniffs traffic on a network looking for session tokens in unencrypted traffic. Once a session token is captured, the attacker performs malicious actions by using the stolen token with the targeted application to impersonate the victim. This attack is a specific method of session hijacking, which is exploiting a valid session token to gain unauthorized access to a target system or information. Other methods to perform a session hijacking are session fixation, cross-site scripting, or compromising a user or server machine and stealing the session token."},{"id":"551","name":"Modify Existing Service","prerequisites":"","related_weakness":["284","522"],"solutions":"Limit privileges of user accounts so service changes can only be performed by authorized administrators. Also monitor any service changes that may occur inadvertently.","summary":"When an operating system starts, it also starts programs called services or daemons. Modifying existing services may break existing services or may enable services that are disabled/not commonly used."},{"id":"561","name":"Windows Admin Shares with Stolen Credentials","prerequisites":"","related_weakness":["522"],"solutions":"Do not reuse local administrator account passwords across systems. Ensure password complexity and uniqueness such that the passwords cannot be cracked or guessed. Deny remote use of local admin credentials to log into systems. Do not allow accounts to be a local administrator on more than one system.","summary":"Windows systems have hidden network shares that are only accessible to administrators and allow files to be written to the local computer. Example network shares include: C$, ADMIN$ and IPC$. Adversaries may use valid administrator credentials to remotely access a network share to transfer files and execute code. It is possible for adversaries to use NTLM hashes to access administrator shares on systems with certain configuration and patch levels."},{"id":"50","name":"Password Recovery Exploitation","prerequisites":"The system allows users to recover their passwords and gain access back into the system. Password recovery mechanism has been designed or implemented insecurely. Password recovery mechanism relies only on something the user knows and not something the user has. No third party intervention is required to use the password recovery mechanism.","related_weakness":["522","640","718"],"solutions":"Use multiple security questions (e.g. have three and make the user answer two of them correctly). Let the user select their own security questions or provide them with choices of questions that are not generic. E-mail the temporary password to the registered e-mail address of the user rather than letting the user reset the password online. Ensure that your password recovery functionality is not vulnerable to an injection style attack.","summary":"An attacker may take advantage of the application feature to help users recover their forgotten passwords in order to gain access into the system with the same privileges as the original user. Generally password recovery schemes tend to be weak and insecure. Most of them use only one security question . For instance, mother's maiden name tends to be a fairly popular one. Unfortunately in many cases this information is not very hard to find, especially if the attacker knows the legitimate user. These generic security questions are also re-used across many applications, thus making them even more insecure. An attacker could for instance overhear a coworker talking to a bank representative at the work place and supplying their mother's maiden name for verification purposes. An attacker can then try to log in into one of the victim's accounts, click on \"forgot password\" and there is a good chance that the security question there will be to provide mother's maiden name. A weak password recovery scheme totally undermines the effectiveness of a strong password scheme."},{"id":"560","name":"Use of Known Domain Credentials","prerequisites":"","related_weakness":["522"],"solutions":"","summary":"An adversary uses stolen credentials (e.g., userid and password) to access systems managed under the same credential framework on a local network. Often, users are allowed to login to connected machines using the same password. Discovery of the password on one machine allows for lateral movement to those machines."}],"cvss":2.6,"cvss-time":"2021-11-18T16:16:00","cvss-vector":"AV:N/AC:H/Au:N/C:P/I:N/A:N","cwe":"CWE-522","id":"CVE-2020-15157","impact":{"availability":"NONE","confidentiality":"PARTIAL","integrity":"NONE"},"last-modified":"2021-11-18T16:16:00","references":["https://github.com/containerd/containerd/security/advisories/GHSA-742w-89gc-8m9c","https://github.com/containerd/containerd/releases/tag/v1.2.14","https://usn.ubuntu.com/4589-1/","https://usn.ubuntu.com/4589-2/","https://www.debian.org/security/2021/dsa-4865"],"refmap":{"confirm":["https://github.com/containerd/containerd/security/advisories/GHSA-742w-89gc-8m9c"],"misc":["https://github.com/containerd/containerd/releases/tag/v1.2.14"],"ubuntu":["USN-4589-1","USN-4589-2"]},"summary":"In containerd (an industry-standard container runtime) before version 1.2.14 there is a credential leaking vulnerability. If a container image manifest in the OCI Image format or Docker Image V2 Schema 2 format includes a URL for the location of a specific image layer (otherwise known as a “foreign layer”), the default containerd resolver will follow that URL to attempt to download it. In v1.2.x but not 1.3.0 or later, the default containerd resolver will provide its authentication credentials if the server where the URL is located presents an HTTP 401 status code along with registry-specific HTTP headers. If an attacker publishes a public image with a manifest that directs one of the layers to be fetched from a web server they control and they trick a user or system into pulling the image, they can obtain the credentials used for pulling that image. In some cases, this may be the user's username and password for the registry. In other cases, this may be the credentials attached to the cloud virtual instance which can grant access to other cloud resources in the account. The default containerd resolver is used by the cri-containerd plugin (which can be used by Kubernetes), the ctr development tool, and other client programs that have explicitly linked against it. This vulnerability has been fixed in containerd 1.2.14. containerd 1.3 and later are not affected. If you are using containerd 1.3 or later, you are not affected. If you are using cri-containerd in the 1.2 series or prior, you should ensure you only pull images from trusted sources. Other container runtimes built on top of containerd but not using the default resolver (such as Docker) are not affected.","vulnerable_configuration":[{"id":"cpe:2.3:a:linuxfoundation:containerd:1.2.0:-:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.2.0:-:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.2.0:beta0:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.2.0:beta0:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.2.0:beta1:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.2.0:beta1:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.2.0:beta2:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.2.0:beta2:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.2.0:rc0:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.2.0:rc0:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.2.0:rc1:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.2.0:rc1:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.2.0:rc2:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.2.0:rc2:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.2.1:-:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.2.1:-:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.2.1:rc0:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.2.1:rc0:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.2.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.2.2:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.2.3:*:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.2.3:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.2.4:*:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.2.4:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.2.5:*:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.2.5:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.2.6:*:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.2.6:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.2.7:*:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.2.7:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.2.8:*:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.2.8:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.2.9:*:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.2.9:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.2.10:*:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.2.10:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.2.11:*:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.2.11:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.2.12:*:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.2.12:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.2.13:*:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.2.13:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.3.0:-:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.3.0:-:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.3.0:beta0:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.3.0:beta0:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.3.0:beta1:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.3.0:beta1:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.3.0:beta2:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.3.0:beta2:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.3.0:rc0:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.3.0:rc0:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.3.0:rc1:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.3.0:rc1:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.3.0:rc2:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.3.0:rc2:*:*:*:*:*:*"},{"id":"cpe:2.3:a:linuxfoundation:containerd:1.3.0:rc3:*:*:*:*:*:*","title":"cpe:2.3:a:linuxfoundation:containerd:1.3.0:rc3:*:*:*:*:*:*"},{"id":"cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*","title":"cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*"},{"id":"cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*","title":"cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*"},{"id":"cpe:2.3:o:canonical:ubuntu_linux:20.04:*:*:*:lts:*:*:*","title":"cpe:2.3:o:canonical:ubuntu_linux:20.04:*:*:*:lts:*:*:*"},{"id":"cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*","title":"cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*"}],"vulnerable_configuration_cpe_2_2":[],"vulnerable_product":["cpe:2.3:a:linuxfoundation:containerd:1.2.0:-:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.2.0:beta0:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.2.0:beta1:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.2.0:beta2:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.2.0:rc0:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.2.0:rc1:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.2.0:rc2:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.2.1:-:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.2.1:rc0:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.2.2:*:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.2.3:*:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.2.4:*:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.2.5:*:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.2.6:*:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.2.7:*:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.2.8:*:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.2.9:*:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.2.10:*:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.2.11:*:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.2.12:*:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.2.13:*:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.3.0:-:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.3.0:beta0:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.3.0:beta1:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.3.0:beta2:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.3.0:rc0:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.3.0:rc1:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.3.0:rc2:*:*:*:*:*:*","cpe:2.3:a:linuxfoundation:containerd:1.3.0:rc3:*:*:*:*:*:*","cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*","cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*","cpe:2.3:o:canonical:ubuntu_linux:20.04:*:*:*:lts:*:*:*","cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*"]}