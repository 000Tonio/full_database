{"Modified":"2021-03-17T16:40:00","Published":"2021-01-05T12:15:00","access":{"authentication":"NONE","complexity":"LOW","vector":"NETWORK"},"assigner":"cve@mitre.org","capec":[{"id":"509","name":"Kerberoasting","prerequisites":"The adversary requires access as an authenticated user on the system. This attack pattern relates to elevating privileges. The adversary requires use of a third-party credential harvesting tool (e.g., Mimikatz). The adversary requires a brute force tool.","related_weakness":["552"],"solutions":"Monitor system and domain logs for abnormal access. Employ a robust password policy for service accounts. Passwords should be of adequate length and complexity, and they should expire after a period of time. Employ the principle of least privilege: limit service accounts privileges to what is required for functionality and no more. Enable AES Kerberos encryption (or another stronger encryption algorithm), rather than RC4, where possible.","summary":"Through the exploitation of how service accounts leverage Kerberos authentication with Service Principal Names (SPNs), the adversary obtains and subsequently cracks the hashed credentials of a service account target to exploit its privileges. The Kerberos authentication protocol centers around a ticketing system which is used to request/grant access to services and to then access the requested services. As an authenticated user, the adversary may request Active Directory and obtain a service ticket with portions encrypted via RC4 with the private key of the authenticated account. By extracting the local ticket and saving it disk, the adversary can brute force the hashed value to reveal the target account credentials."},{"id":"639","name":"Probe System Files","prerequisites":"An adversary has access to the file system of a system.","related_weakness":["552"],"solutions":"Verify that files have proper access controls set, and reduce the storage of sensitive information to only what is necessary.","summary":"An adversary obtains unauthorized information due to improperly protected files. If an application stores sensitive information in a file that is not protected by proper access control, then an adversary can access the file and search for sensitive information."},{"id":"150","name":"Collect Data from Common Resource Locations","prerequisites":"The targeted applications must either expect files to be located at a specific location or, if the location of the files can be configured by the user, the user either failed to move the files from the default location or placed them in a conventional location for files of the given type.","related_weakness":["552"],"solutions":"","summary":"An adversary exploits well-known locations for resources for the purposes of undermining the security of the target. In many, if not most systems, files and resources are organized in a default tree structure. This can be useful for adversaries because they often know where to look for resources or files that are necessary for attacks. Even when the precise location of a targeted resource may not be known, naming conventions may indicate a small area of the target machine's file tree where the resources are typically located. For example, configuration files are normally stored in the /etc director on Unix systems. Adversaries can take advantage of this to commit other types of attacks."}],"cvss":5,"cvss-time":"2021-03-17T16:40:00","cvss-vector":"AV:N/AC:L/Au:N/C:P/I:N/A:N","cwe":"CWE-552","id":"CVE-2020-17519","impact":{"availability":"NONE","confidentiality":"PARTIAL","integrity":"NONE"},"last-modified":"2021-03-17T16:40:00","references":["http://packetstormsecurity.com/files/160849/Apache-Flink-1.11.0-Arbitrary-File-Read-Directory-Traversal.html","http://www.openwall.com/lists/oss-security/2021/01/05/2","https://lists.apache.org/thread.html/r0a433be10676f4fe97ca423d08f914e0ead341c901216f292d2bbe83@%3Cissues.flink.apache.org%3E","https://lists.apache.org/thread.html/r1125f3044a0946d1e7e6f125a6170b58d413ebd4a95157e4608041c7@%3Cannounce.apache.org%3E","https://lists.apache.org/thread.html/r229167538863518738e02f4c1c5a8bb34c1d45dadcc97adf6676b0c1@%3Cdev.flink.apache.org%3E","https://lists.apache.org/thread.html/r26fcdd4fe288323006253437ebc4dd6fdfadfb5e93465a0e4f68420d@%3Cuser-zh.flink.apache.org%3E","https://lists.apache.org/thread.html/r28f17e564950d663e68cc6fe75756012dda62ac623766bb9bc5e7034@%3Cissues.flink.apache.org%3E","https://lists.apache.org/thread.html/r2fc60b30557e4a537c2a6293023049bd1c49fd92b518309aa85a0398@%3Cissues.flink.apache.org%3E","https://lists.apache.org/thread.html/r4e1b72bfa789ea5bc20b8afe56119200ed25bdab0eb80d664fa5bfe2@%3Cdev.flink.apache.org%3E","https://lists.apache.org/thread.html/r6843202556a6d0bce9607ebc02e303f68fc88e9038235598bde3b50d%40%3Cdev.flink.apache.org%3E","https://lists.apache.org/thread.html/r6843202556a6d0bce9607ebc02e303f68fc88e9038235598bde3b50d@%3Cannounce.apache.org%3E","https://lists.apache.org/thread.html/r6843202556a6d0bce9607ebc02e303f68fc88e9038235598bde3b50d@%3Cdev.flink.apache.org%3E","https://lists.apache.org/thread.html/r6843202556a6d0bce9607ebc02e303f68fc88e9038235598bde3b50d@%3Cuser.flink.apache.org%3E","https://lists.apache.org/thread.html/r88b55f3ebf1f8f4e1cc61f030252aaef4b77060b56557a243abb92a1@%3Cissues.flink.apache.org%3E","https://lists.apache.org/thread.html/r88f427865fb6aa6e6378efe07632a1906b430365e15e3b9621aabe1d@%3Cissues.flink.apache.org%3E","https://lists.apache.org/thread.html/r90890afea72a9571d666820b2fe5942a0a5f86be406fa31da3dd0922@%3Cannounce.apache.org%3E","https://lists.apache.org/thread.html/ra8c96bf3ccb4e491f9ce87ba35f134b4449beb2a38d1ce28fd89001f@%3Cdev.flink.apache.org%3E"],"refmap":{"misc":["http://packetstormsecurity.com/files/160849/Apache-Flink-1.11.0-Arbitrary-File-Read-Directory-Traversal.html","https://lists.apache.org/thread.html/r6843202556a6d0bce9607ebc02e303f68fc88e9038235598bde3b50d%40%3Cdev.flink.apache.org%3E"],"mlist":["[announce] 20210105 [CVE-2020-17519] Apache Flink directory traversal attack: reading remote files through the REST API","[flink-dev] 20210105 [CVE-2020-17519] Apache Flink directory traversal attack: reading remote files through the REST API","[flink-dev] 20210110 [jira] [Created] (FLINK-20916) Typo in test for CVE-2020-17519","[flink-dev] 20210113 Re: [DISCUSS] Releasing Apache Flink 1.10.3","[flink-dev] 20210115 Re: [DISCUSS] Releasing Apache Flink 1.10.3","[flink-issues] 20210106 [GitHub] [flink-web] zentol commented on a change in pull request #408: Add security page for Flink","[flink-issues] 20210110 [jira] [Created] (FLINK-20916) Typo in test for CVE-2020-17519","[flink-issues] 20210110 [jira] [Updated] (FLINK-20916) Typo in test for CVE-2020-17519","[flink-issues] 20210111 [jira] [Assigned] (FLINK-20916) Typo in test for CVE-2020-17519","[flink-issues] 20210111 [jira] [Commented] (FLINK-20916) Typo in test for CVE-2020-17519","[flink-user] 20210105 [CVE-2020-17519] Apache Flink directory traversal attack: reading remote files through the REST API","[oss-security] 20210105 [CVE-2020-17519] Apache Flink directory traversal attack: reading remote files through the REST API"]},"summary":"A change introduced in Apache Flink 1.11.0 (and released in 1.11.1 and 1.11.2 as well) allows attackers to read any file on the local filesystem of the JobManager through the REST interface of the JobManager process. Access is restricted to files accessible by the JobManager process. All users should upgrade to Flink 1.11.3 or 1.12.0 if their Flink instance(s) are exposed. The issue was fixed in commit b561010b0ee741543c3953306037f00d7a9f0801 from apache/flink:master.","vulnerable_configuration":[{"id":"cpe:2.3:a:apache:flink:1.11.0:-:*:*:*:*:*:*","title":"cpe:2.3:a:apache:flink:1.11.0:-:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:flink:1.11.0:rc1:*:*:*:*:*:*","title":"cpe:2.3:a:apache:flink:1.11.0:rc1:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:flink:1.11.0:rc2:*:*:*:*:*:*","title":"cpe:2.3:a:apache:flink:1.11.0:rc2:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:flink:1.11.0:rc3:*:*:*:*:*:*","title":"cpe:2.3:a:apache:flink:1.11.0:rc3:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:flink:1.11.0:rc4:*:*:*:*:*:*","title":"cpe:2.3:a:apache:flink:1.11.0:rc4:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:flink:1.11.1:-:*:*:*:*:*:*","title":"cpe:2.3:a:apache:flink:1.11.1:-:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:flink:1.11.1:rc1:*:*:*:*:*:*","title":"cpe:2.3:a:apache:flink:1.11.1:rc1:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:flink:1.11.2:-:*:*:*:*:*:*","title":"cpe:2.3:a:apache:flink:1.11.2:-:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:flink:1.11.2:rc1:*:*:*:*:*:*","title":"cpe:2.3:a:apache:flink:1.11.2:rc1:*:*:*:*:*:*"}],"vulnerable_configuration_cpe_2_2":[],"vulnerable_product":["cpe:2.3:a:apache:flink:1.11.0:-:*:*:*:*:*:*","cpe:2.3:a:apache:flink:1.11.0:rc1:*:*:*:*:*:*","cpe:2.3:a:apache:flink:1.11.0:rc2:*:*:*:*:*:*","cpe:2.3:a:apache:flink:1.11.0:rc3:*:*:*:*:*:*","cpe:2.3:a:apache:flink:1.11.0:rc4:*:*:*:*:*:*","cpe:2.3:a:apache:flink:1.11.1:-:*:*:*:*:*:*","cpe:2.3:a:apache:flink:1.11.1:rc1:*:*:*:*:*:*","cpe:2.3:a:apache:flink:1.11.2:-:*:*:*:*:*:*","cpe:2.3:a:apache:flink:1.11.2:rc1:*:*:*:*:*:*"]}