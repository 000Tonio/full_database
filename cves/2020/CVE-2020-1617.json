{"Modified":"2020-04-13T17:43:00","Published":"2020-04-08T20:15:00","access":{"authentication":"NONE","complexity":"LOW","vector":"NETWORK"},"assigner":"cve@mitre.org","capec":[{"id":"26","name":"Leveraging Race Conditions","prerequisites":"A resource is accessed/modified concurrently by multiple processes such that a race condition exists. The adversary has the ability to modify the resource.","related_weakness":["362","363","366","368","370","662","665","667","689"],"solutions":"Use safe libraries to access resources such as files. Be aware that improper use of access function calls such as chown(), tempfile(), chmod(), etc. can cause a race condition. Use synchronization to control the flow of execution. Use static analysis tools to find race conditions. Pay attention to concurrency problems related to the access of resources.","summary":"The adversary targets a race condition occurring when multiple processes access and manipulate the same resource concurrently, and the outcome of the execution depends on the particular order in which the access takes place. The adversary can leverage a race condition by \"running the race\", modifying the resource and modifying the normal execution flow. For instance, a race condition can occur while accessing a file: the adversary can trick the system by replacing the original file with his version and cause the system to read the malicious file."},{"id":"29","name":"Leveraging Time-of-Check and Time-of-Use (TOCTOU) Race Conditions","prerequisites":"A resource is access/modified concurrently by multiple processes. The adversary is able to modify resource. A race condition exists while accessing a resource.","related_weakness":["362","366","367","368","370","662","663","665","691"],"solutions":"Use safe libraries to access resources such as files. Be aware that improper use of access function calls such as chown(), tempfile(), chmod(), etc. can cause a race condition. Use synchronization to control the flow of execution. Use static analysis tools to find race conditions. Pay attention to concurrency problems related to the access of resources.","summary":"This attack targets a race condition occurring between the time of check (state) for a resource and the time of use of a resource. A typical example is file access. The adversary can leverage a file access race condition by \"running the race\", meaning that they would modify the resource between the first time the target program accesses the file and the time the target program uses the file. During that period of time, the adversary could replace or modify the file, causing the application to behave unexpectedly."}],"cvss":7.8,"cvss-time":"2020-04-13T17:43:00","cvss-vector":"AV:N/AC:L/Au:N/C:N/I:N/A:C","cwe":"CWE-665","id":"CVE-2020-1617","impact":{"availability":"COMPLETE","confidentiality":"NONE","integrity":"NONE"},"last-modified":"2020-04-13T17:43:00","references":["https://github.com/Juniper/AFI","https://kb.juniper.net/JSA11000","https://www.juniper.net/documentation/en_US/junos/topics/example/example-configuring-vpws-service-with-evpn-signaling-mechanisms.html"],"refmap":{"misc":["https://github.com/Juniper/AFI","https://kb.juniper.net/JSA11000","https://www.juniper.net/documentation/en_US/junos/topics/example/example-configuring-vpws-service-with-evpn-signaling-mechanisms.html"]},"summary":"This issue occurs on Juniper Networks Junos OS devices which do not support Advanced Forwarding Interface (AFI) / Advanced Forwarding Toolkit (AFT). Devices using AFI and AFT are not exploitable to this issue. An improper initialization of memory in the packet forwarding architecture in Juniper Networks Junos OS non-AFI/AFT platforms which may lead to a Denial of Service (DoS) vulnerability being exploited when a genuine packet is received and inspected by non-AFT/AFI sFlow and when the device is also configured with firewall policers. This first genuine packet received and inspected by sampled flow (sFlow) through a specific firewall policer will cause the device to reboot. After the reboot has completed, if the device receives and sFlow inspects another genuine packet seen through a specific firewall policer, the device will generate a core file and reboot. Continued inspection of these genuine packets will create an extended Denial of Service (DoS) condition. Depending on the method for service restoration, e.g. hard boot or soft reboot, a core file may or may not be generated the next time the packet is received and inspected by sFlow. This issue affects: Juniper Networks Junos OS 17.4 versions prior to 17.4R2-S9, 17.4R3 on PTX1000 and PTX10000 Series, QFX10000 Series; 18.1 versions prior to 18.1R3-S9 on PTX1000 and PTX10000 Series, QFX10000 Series; 18.2X75 versions prior to 18.2X75-D12, 18.2X75-D30 on PTX1000 and PTX10000 Series, QFX10000 Series; 18.2 versions prior to 18.2R3 on PTX1000 and PTX10000 Series, QFX10000 Series; 18.3 versions prior to 18.3R3 on PTX1000 and PTX10000 Series, QFX10000 Series. This issue is not applicable to Junos OS versions before 17.4R1. This issue is not applicable to Junos OS Evolved or Junos OS with Advanced Forwarding Toolkit (AFT) forwarding implementations which use a different implementation of sFlow. The following example information is unrelated to this issue and is provided solely to assist you with determining if you have AFT or not. Example: A Junos OS device which supports the use of EVPN signaled VPWS with Flexible Cross Connect uses the AFT implementation. Since this configuration requires support and use of the AFT implementation to support this configuration, the device is not vulnerable to this issue as the sFlow implementation is different using the AFT architecture. For further details about AFT visit the AFI / AFT are in the links below. If you are uncertain if you use the AFI/AFT implementation or not, there are configuration examples in the links below which you may use to determine if you are vulnerable to this issue or not. If the commands work, you are. If not, you are not. You may also use the Feature Explorer to determine if AFI/AFT is supported or not. If you are still uncertain, please contact your support resources.","vulnerable_configuration":[{"id":"cpe:2.3:a:juniper:junos:18.2:r1:*:*:*:*:*:*","title":"cpe:2.3:a:juniper:junos:18.2:r1:*:*:*:*:*:*"},{"id":"cpe:2.3:a:juniper:junos:18.2:r1-s3:*:*:*:*:*:*","title":"cpe:2.3:a:juniper:junos:18.2:r1-s3:*:*:*:*:*:*"},{"id":"cpe:2.3:a:juniper:junos:18.2:r1-s4:*:*:*:*:*:*","title":"cpe:2.3:a:juniper:junos:18.2:r1-s4:*:*:*:*:*:*"},{"id":"cpe:2.3:a:juniper:junos:18.2:r2:*:*:*:*:*:*","title":"cpe:2.3:a:juniper:junos:18.2:r2:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:17.4:-:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:17.4:-:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:17.4:r1:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:17.4:r1:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:17.4:r1-s1:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:17.4:r1-s1:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:17.4:r1-s2:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:17.4:r1-s2:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:17.4:r1-s4:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:17.4:r1-s4:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:17.4:r1-s5:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:17.4:r1-s5:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:17.4:r1-s6:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:17.4:r1-s6:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:17.4:r1-s7:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:17.4:r1-s7:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:17.4:r2:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:17.4:r2:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:17.4:r2-s1:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:17.4:r2-s1:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:17.4:r2-s2:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:17.4:r2-s2:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:17.4:r2-s3:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:17.4:r2-s3:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:17.4:r2-s4:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:17.4:r2-s4:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:17.4:r2-s5:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:17.4:r2-s5:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:17.4:r2-s6:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:17.4:r2-s6:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:17.4:r2-s7:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:17.4:r2-s7:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:17.4:r2-s8:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:17.4:r2-s8:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.1:-:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.1:-:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.1:r2:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.1:r2:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.1:r2-s1:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.1:r2-s1:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.1:r2-s2:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.1:r2-s2:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.1:r2-s4:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.1:r2-s4:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.1:r3:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.1:r3:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.1:r3-s1:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.1:r3-s1:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.1:r3-s2:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.1:r3-s2:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.1:r3-s3:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.1:r3-s3:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.1:r3-s4:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.1:r3-s4:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.1:r3-s6:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.1:r3-s6:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.1:r3-s7:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.1:r3-s7:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.1:r3-s8:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.1:r3-s8:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.2:-:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.2:-:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.2:r1:-:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.2:r1:-:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.2:r1-s3:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.2:r1-s3:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.2:r1-s5:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.2:r1-s5:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.2:r2-s1:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.2:r2-s1:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.2:r2-s2:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.2:r2-s2:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.2:r2-s3:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.2:r2-s3:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.2:r2-s4:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.2:r2-s4:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.2:r2-s5:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.2:r2-s5:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.2:r2-s6:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.2:r2-s6:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.2x75:*:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.2x75:*:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.2x75:-:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.2x75:-:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.2x75-d10:*:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.2x75-d10:*:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.3:-:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.3:-:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.3:r1:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.3:r1:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.3:r1-s1:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.3:r1-s1:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.3:r1-s2:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.3:r1-s2:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.3:r1-s3:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.3:r1-s3:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.3:r1-s5:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.3:r1-s5:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.3:r2:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.3:r2:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.3:r2-s1:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.3:r2-s1:*:*:*:*:*:*"},{"id":"cpe:2.3:o:juniper:junos:18.3:r2-s2:*:*:*:*:*:*","title":"cpe:2.3:o:juniper:junos:18.3:r2-s2:*:*:*:*:*:*"},{"id":"cpe:2.3:h:juniper:ptx1000:-:*:*:*:*:*:*:*","title":"cpe:2.3:h:juniper:ptx1000:-:*:*:*:*:*:*:*"},{"id":"cpe:2.3:h:juniper:ptx10000:-:*:*:*:*:*:*:*","title":"cpe:2.3:h:juniper:ptx10000:-:*:*:*:*:*:*:*"},{"id":"cpe:2.3:h:juniper:ptx10001:-:*:*:*:*:*:*:*","title":"cpe:2.3:h:juniper:ptx10001:-:*:*:*:*:*:*:*"},{"id":"cpe:2.3:h:juniper:ptx10002:-:*:*:*:*:*:*:*","title":"cpe:2.3:h:juniper:ptx10002:-:*:*:*:*:*:*:*"},{"id":"cpe:2.3:h:juniper:ptx10003:-:*:*:*:*:*:*:*","title":"cpe:2.3:h:juniper:ptx10003:-:*:*:*:*:*:*:*"},{"id":"cpe:2.3:h:juniper:ptx10008:-:*:*:*:*:*:*:*","title":"cpe:2.3:h:juniper:ptx10008:-:*:*:*:*:*:*:*"},{"id":"cpe:2.3:h:juniper:ptx10016:-:*:*:*:*:*:*:*","title":"cpe:2.3:h:juniper:ptx10016:-:*:*:*:*:*:*:*"},{"id":"cpe:2.3:h:juniper:ptx3000:-:*:*:*:*:*:*:*","title":"cpe:2.3:h:juniper:ptx3000:-:*:*:*:*:*:*:*"},{"id":"cpe:2.3:h:juniper:ptx5000:-:*:*:*:*:*:*:*","title":"cpe:2.3:h:juniper:ptx5000:-:*:*:*:*:*:*:*"},{"id":"cpe:2.3:h:juniper:qfx10008:-:*:*:*:*:*:*:*","title":"cpe:2.3:h:juniper:qfx10008:-:*:*:*:*:*:*:*"},{"id":"cpe:2.3:h:juniper:qfx10016:-:*:*:*:*:*:*:*","title":"cpe:2.3:h:juniper:qfx10016:-:*:*:*:*:*:*:*"}],"vulnerable_configuration_cpe_2_2":[],"vulnerable_product":["cpe:2.3:a:juniper:junos:18.2:r1:*:*:*:*:*:*","cpe:2.3:a:juniper:junos:18.2:r1-s3:*:*:*:*:*:*","cpe:2.3:a:juniper:junos:18.2:r1-s4:*:*:*:*:*:*","cpe:2.3:a:juniper:junos:18.2:r2:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:17.4:-:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:17.4:r1:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:17.4:r1-s1:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:17.4:r1-s2:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:17.4:r1-s4:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:17.4:r1-s5:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:17.4:r1-s6:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:17.4:r1-s7:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:17.4:r2:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:17.4:r2-s1:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:17.4:r2-s2:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:17.4:r2-s3:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:17.4:r2-s4:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:17.4:r2-s5:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:17.4:r2-s6:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:17.4:r2-s7:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:17.4:r2-s8:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.1:-:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.1:r2:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.1:r2-s1:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.1:r2-s2:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.1:r2-s4:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.1:r3:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.1:r3-s1:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.1:r3-s2:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.1:r3-s3:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.1:r3-s4:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.1:r3-s6:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.1:r3-s7:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.1:r3-s8:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.2:-:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.2:r1:-:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.2:r1-s3:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.2:r1-s5:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.2:r2-s1:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.2:r2-s2:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.2:r2-s3:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.2:r2-s4:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.2:r2-s5:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.2:r2-s6:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.2x75:*:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.2x75:-:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.2x75-d10:*:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.3:-:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.3:r1:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.3:r1-s1:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.3:r1-s2:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.3:r1-s3:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.3:r1-s5:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.3:r2:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.3:r2-s1:*:*:*:*:*:*","cpe:2.3:o:juniper:junos:18.3:r2-s2:*:*:*:*:*:*"]}