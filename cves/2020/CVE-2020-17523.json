{"Modified":"2022-02-22T10:16:00","Published":"2021-02-03T17:15:00","access":{"authentication":"NONE","complexity":"LOW","vector":"NETWORK"},"assigner":"security@apache.org","capec":[{"id":"94","name":"Man in the Middle Attack","prerequisites":"There are two components communicating with each other. An attacker is able to identify the nature and mechanism of communication between the two target components. An attacker can eavesdrop on the communication between the target components. Strong mutual authentication is not used between the two target components yielding opportunity for attacker interposition. The communication occurs in clear (not encrypted) or with insufficient and spoofable encryption.","related_weakness":["287","290","294","300","593","724"],"solutions":"Get your Public Key signed by a Certificate Authority Encrypt your communication using cryptography (SSL,...) Use Strong mutual authentication to always fully authenticate both ends of any communications channel. Exchange public keys using a secure channel","summary":"This type of attack targets the communication between two components (typically client and server). The attacker places himself in the communication channel between the two components. Whenever one component attempts to communicate with the other (data flow, authentication challenges, etc.), the data first goes to the attacker, who has the opportunity to observe or alter it, and it is then passed on to the other component as if it was never observed. This interposition is transparent leaving the two compromised components unaware of the potential corruption or leakage of their communications. The potential for Man-in-the-Middle attacks yields an implicit lack of trust in communication or identify between two components. MITM attacks differ from sniffing attacks since they often modify the communications prior to delivering it to the intended recipient. These attacks also differ from interception attacks since they may forward the sender's original unmodified data, after copying it, instead of keeping it for themselves."},{"id":"57","name":"Utilizing REST's Trust in the System Resource to Obtain Sensitive Data","prerequisites":"Opportunity to intercept must exist beyond the point where SSL is terminated. The attacker must be able to insert a listener actively (proxying the communication) or passively (sniffing the communication) in the client-server communication path.","related_weakness":["287","300","693","724"],"solutions":"Implementation: Implement message level security such as HMAC in the HTTP communication Design: Utilize defense in depth, do not rely on a single security mechanism like SSL Design: Enforce principle of least privilege","summary":"This attack utilizes a REST(REpresentational State Transfer)-style applications' trust in the system resources and environment to obtain sensitive data once SSL is terminated. Rest applications premise is that they leverage existing infrastructure to deliver web services functionality. An example of this is a Rest application that uses HTTP Get methods and receives a HTTP response with an XML document. These Rest style web services are deployed on existing infrastructure such as Apache and IIS web servers with no SOAP stack required. Unfortunately from a security standpoint, there frequently is no interoperable identity security mechanism deployed, so Rest developers often fall back to SSL to deliver security. In large data centers, SSL is typically terminated at the edge of the network - at the firewall, load balancer, or router. Once the SSL is terminated the HTTP request is in the clear (unless developers have hashed or encrypted the values, but this is rare). The attacker can utilize a sniffer such as Wireshark to snapshot the credentials, such as username and password that are passed in the clear once SSL is terminated. Once the attacker gathers these credentials, they can submit requests to the web service provider just as authorized user do. There is not typically an authentication on the client side, beyond what is passed in the request itself so once this is compromised, then this is generally sufficient to compromise the service's authentication scheme."},{"id":"593","name":"Session Hijacking","prerequisites":"An application that leverages sessions to perform authentication.","related_weakness":["287"],"solutions":"Properly encrypt and sign identity tokens in transit, and use industry standard session key generation mechanisms that utilize high amount of entropy to generate the session key. Many standard web and application servers will perform this task on your behalf. Utilize a session timeout for all sessions. If the user does not explicitly logout, terminate their session after this period of inactivity. If the user logs back in then a new session key should be generated.","summary":"This type of attack involves an adversary that exploits weaknesses in an application's use of sessions in performing authentication. The advarsary is able to steal or manipulate an active session and use it to gain unathorized access to the application."},{"id":"194","name":"Fake the Source of Data","prerequisites":"This attack is only applicable when a vulnerable entity associates data or services with an identity. Without such an association, there would be no reason to fake the source.","related_weakness":["287"],"solutions":"","summary":"An adversary takes advantage of improper authentication to provide data or services under a falsified identity. The purpose of using the falsified identity may be to prevent traceability of the provided data or to assume the rights granted to another individual. One of the simplest forms of this attack would be the creation of an email message with a modified \"From\" field in order to appear that the message was sent from someone other than the actual sender. The root of the attack (in this case the email system) fails to properly authenticate the source and this results in the reader incorrectly performing the instructed action. Results of the attack vary depending on the details of the attack, but common results include privilege escalation, obfuscation of other attacks, and data corruption/manipulation."},{"id":"114","name":"Authentication Abuse","prerequisites":"An authentication mechanism or subsystem implementing some form of authentication such as passwords, digest authentication, security certificates, etc. which is flawed in some way.","related_weakness":["287"],"solutions":"","summary":"An attacker obtains unauthorized access to an application, service or device either through knowledge of the inherent weaknesses of an authentication mechanism, or by exploiting a flaw in the authentication scheme's implementation. In such an attack an authentication mechanism is functioning but a carefully controlled sequence of events causes the mechanism to grant access to the attacker. This attack may exploit assumptions made by the target's authentication procedures, such as assumptions regarding trust relationships or assumptions regarding the generation of secret values. This attack differs from Authentication Bypass attacks in that Authentication Abuse allows the attacker to be certified as a valid user through illegitimate means, while Authentication Bypass allows the user to access protected material without ever being certified as an authenticated user. This attack does not rely on prior sessions established by successfully authenticating users, as relied upon for the \"Exploitation of Session Variables, Resource IDs and other Trusted Credentials\" attack patterns."},{"id":"151","name":"Identity Spoofing","prerequisites":"The identity associated with the message or resource must be removable or modifiable in an undetectable way.","related_weakness":["287"],"solutions":"Employ robust authentication processes (e.g., multi-factor authentication).","summary":"Identity Spoofing refers to the action of assuming (i.e., taking on) the identity of some other entity (human or non-human) and then using that identity to accomplish a goal. An adversary may craft messages that appear to come from a different principle or use stolen / spoofed authentication credentials. Alternatively, an adversary may intercept a message from a legitimate sender and attempt to make it look like the message comes from them without changing its content. The latter form of this attack can be used to hijack credentials from legitimate users. Identity Spoofing attacks need not be limited to transmitted messages - any resource that is associated with an identity (for example, a file with a signature) can be the target of an attack where the adversary attempts to change the apparent identity. This attack differs from Content Spoofing attacks where the adversary does not wish to change the apparent identity of the message but instead wishes to change what the message says. In an Identity Spoofing attack, the adversary is attempting to change the identity of the content."},{"id":"633","name":"Token Impersonation","prerequisites":"This pattern of attack is only applicable when a downstream user leverages tokens to verify identity, and then takes action based on that identity.","related_weakness":["287"],"solutions":"","summary":"An adversary exploits a weakness in authentication to create an access token (or equivalent) that impersonates a different entity, and then associates a process/thread to that that impersonated token. This action causes a downstream user to make a decision or take action that is based on the assumed identity, and not the response that blocks the adversary."},{"id":"115","name":"Authentication Bypass","prerequisites":"An authentication mechanism or subsystem implementing some form of authentication such as passwords, digest authentication, security certificates, etc.","related_weakness":["287"],"solutions":"","summary":"An attacker gains access to application, service, or device with the privileges of an authorized or privileged user by evading or circumventing an authentication mechanism. The attacker is therefore able to access protected data without authentication ever having taken place. This refers to an attacker gaining access equivalent to an authenticated user without ever going through an authentication procedure. This is usually the result of the attacker using an unexpected access procedure that does not go through the proper checkpoints where authentication should occur. For example, a web site might assume that all users will click through a given link in order to get to secure material and simply authenticate everyone that clicks the link. However, an attacker might be able to reach secured web content by explicitly entering the path to the content rather than clicking through the authentication link, thereby avoiding the check entirely. This attack pattern differs from other authentication attacks in that attacks of this pattern avoid authentication entirely, rather than faking authentication by exploiting flaws or by stealing credentials from legitimate users."},{"id":"22","name":"Exploiting Trust in Client","prerequisites":"Server software must rely on client side formatted and validated values, and not reinforce these checks on the server side.","related_weakness":["20","200","287","290","693"],"solutions":"Design: Ensure that client process and/or message is authenticated so that anonymous communications and/or messages are not accepted by the system. Design: Do not rely on client validation or encoding for security purposes. Design: Utilize digital signatures to increase authentication assurance. Design: Utilize two factor authentication to increase authentication assurance. Implementation: Perform input validation for all remote content.","summary":"An attack of this type exploits vulnerabilities in client/server communication channel authentication and data integrity. It leverages the implicit trust a server places in the client, or more importantly, that which the server believes is the client. An attacker executes this type of attack by communicating directly with the server where the server believes it is communicating only with a valid client. There are numerous variations of this type of attack."},{"id":"650","name":"Upload a Web Shell to a Web Server","prerequisites":"The web server is susceptible to one of the various web application exploits that allows for uploading a shell file.","related_weakness":["287","553"],"solutions":"Insure that the file permissions in directories on the web server from which files can be execute is set to the \"least privilege\" settings, and that those directories contents is controlled by a whitelist.","summary":"By exploiting insufficient permissions, it is possible to upload a web shell to a web server in such a way that it can be executed remotely. This shell can have various capabilities, thereby acting as a \"gateway\" to the underlying web server. The shell might execute at the higher permission level of the web server, providing the ability the execute malicious code at elevated levels."}],"cvss":9,"cvss-time":"2022-02-22T10:16:00","cvss-vector":"AV:N/AC:L/Au:N/C:P/I:P/A:C","cwe":"CWE-287","id":"CVE-2020-17523","impact":{"availability":"COMPLETE","confidentiality":"PARTIAL","integrity":"PARTIAL"},"last-modified":"2022-02-22T10:16:00","references":["https://lists.apache.org/thread.html/rce5943430a6136d37a1f2fc201d245fe094e2727a0bc27e3b2d43a39%40%3Cdev.shiro.apache.org%3E","https://lists.apache.org/thread.html/r5b93ddf97e2c4cda779d22fab30539bdec454cfa5baec4ad0ffae235@%3Cgitbox.activemq.apache.org%3E","https://lists.apache.org/thread.html/rd4b613e121438b97e3eb263cac3137caddb1dbd8f648b73a4f1898a6@%3Cissues.activemq.apache.org%3E","https://lists.apache.org/thread.html/r9d93dfb5df016b1a71a808486bc8f9fbafebbdbc8533625f91253f1d@%3Cdev.shiro.apache.org%3E","https://lists.apache.org/thread.html/re25b8317b00a50272a7252c4552cf1a81a97984cc2111ef7728e48e0@%3Cdev.shiro.apache.org%3E","https://lists.apache.org/thread.html/r679ca97813384bdb1a4c087810ba44d9ad9c7c11583979bb7481d196@%3Cdev.shiro.apache.org%3E","https://lists.apache.org/thread.html/r8244fd0831db894d5e89911ded9c72196d395a90ae655414d23ed0dd@%3Cusers.activemq.apache.org%3E","https://lists.apache.org/thread.html/r852971e28f54cafa7d325bd7033115c67d613b112a2a1076817390ac@%3Cdev.shiro.apache.org%3E"],"summary":"Apache Shiro before 1.7.1, when using Apache Shiro with Spring, a specially crafted HTTP request may cause an authentication bypass.","vulnerable_configuration":[{"id":"cpe:2.3:a:apache:shiro:-:*:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:-:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:shiro:1.1.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:1.1.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:shiro:1.2.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:1.2.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:shiro:1.2.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:1.2.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:shiro:1.2.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:1.2.2:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:shiro:1.2.3:*:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:1.2.3:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:shiro:1.2.4:*:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:1.2.4:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:shiro:1.2.5:*:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:1.2.5:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:shiro:1.2.6:*:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:1.2.6:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:shiro:1.3.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:1.3.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:shiro:1.3.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:1.3.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:shiro:1.3.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:1.3.2:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:shiro:1.4.0:-:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:1.4.0:-:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:shiro:1.4.0:rc1:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:1.4.0:rc1:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:shiro:1.4.0:rc2:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:1.4.0:rc2:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:shiro:1.4.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:1.4.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:shiro:1.4.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:1.4.2:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:shiro:1.5.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:1.5.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:shiro:1.5.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:1.5.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:shiro:1.5.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:1.5.2:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:shiro:1.5.3:*:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:1.5.3:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:shiro:1.6.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:1.6.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:apache:shiro:1.7.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:apache:shiro:1.7.0:*:*:*:*:*:*:*"}],"vulnerable_configuration_cpe_2_2":[],"vulnerable_product":["cpe:2.3:a:apache:shiro:-:*:*:*:*:*:*:*","cpe:2.3:a:apache:shiro:1.1.0:*:*:*:*:*:*:*","cpe:2.3:a:apache:shiro:1.2.0:*:*:*:*:*:*:*","cpe:2.3:a:apache:shiro:1.2.1:*:*:*:*:*:*:*","cpe:2.3:a:apache:shiro:1.2.2:*:*:*:*:*:*:*","cpe:2.3:a:apache:shiro:1.2.3:*:*:*:*:*:*:*","cpe:2.3:a:apache:shiro:1.2.4:*:*:*:*:*:*:*","cpe:2.3:a:apache:shiro:1.2.5:*:*:*:*:*:*:*","cpe:2.3:a:apache:shiro:1.2.6:*:*:*:*:*:*:*","cpe:2.3:a:apache:shiro:1.3.0:*:*:*:*:*:*:*","cpe:2.3:a:apache:shiro:1.3.1:*:*:*:*:*:*:*","cpe:2.3:a:apache:shiro:1.3.2:*:*:*:*:*:*:*","cpe:2.3:a:apache:shiro:1.4.0:-:*:*:*:*:*:*","cpe:2.3:a:apache:shiro:1.4.0:rc1:*:*:*:*:*:*","cpe:2.3:a:apache:shiro:1.4.0:rc2:*:*:*:*:*:*","cpe:2.3:a:apache:shiro:1.4.1:*:*:*:*:*:*:*","cpe:2.3:a:apache:shiro:1.4.2:*:*:*:*:*:*:*","cpe:2.3:a:apache:shiro:1.5.0:*:*:*:*:*:*:*","cpe:2.3:a:apache:shiro:1.5.1:*:*:*:*:*:*:*","cpe:2.3:a:apache:shiro:1.5.2:*:*:*:*:*:*:*","cpe:2.3:a:apache:shiro:1.5.3:*:*:*:*:*:*:*","cpe:2.3:a:apache:shiro:1.6.0:*:*:*:*:*:*:*","cpe:2.3:a:apache:shiro:1.7.0:*:*:*:*:*:*:*"]}