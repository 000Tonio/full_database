{"Modified":"2021-09-10T19:41:00","Published":"2021-09-01T20:15:00","access":{"authentication":"SINGLE","complexity":"LOW","vector":"NETWORK"},"assigner":"security-advisories@github.com","capec":[{"id":"83","name":"XPath Injection","prerequisites":"XPath queries used to retrieve information stored in XML documents User-controllable input not properly sanitized before being used as part of XPath queries","related_weakness":["20","707","713","74","91"],"solutions":"Strong input validation - All user-controllable input must be validated and filtered for illegal characters as well as content that can be interpreted in the context of an XPath expression. Characters such as a single-quote(') or operators such as or (|), and (&) and such should be filtered if the application does not expect them in the context in which they appear. If such content cannot be filtered, it must at least be properly escaped to avoid them being interpreted as part of XPath expressions. Use of parameterized XPath queries - Parameterization causes the input to be restricted to certain domains, such as strings or integers, and any input outside such domains is considered invalid and the query fails. Use of custom error pages - Attackers can glean information about the nature of queries from descriptive error messages. Input validation must be coupled with customized error pages that inform about an error without disclosing information about the database or application.","summary":"An attacker can craft special user-controllable input consisting of XPath expressions to inject the XML database and bypass authentication or glean information that he normally would not be able to. XPath Injection enables an attacker to talk directly to the XML database, thus bypassing the application completely. XPath Injection results from the failure of an application to properly sanitize input used as part of dynamic XPath expressions used to query an XML database."},{"id":"250","name":"XML Injection","prerequisites":"XML queries used to process user input and retrieve information stored in XML documents User-controllable input not properly sanitized","related_weakness":["20","707","713","74","91"],"solutions":"Use of custom error pages - Attackers can glean information about the nature of queries from descriptive error messages. Input validation must be coupled with customized error pages that inform about an error without disclosing information about the database or application.","summary":"An attacker utilizes crafted XML user-controllable input to probe, attack, and inject data into the XML database, using techniques similar to SQL injection. The user-controllable input can allow for unauthorized viewing of data, bypassing authentication or the front-end application for direct XML database access, and possibly altering database information."}],"cvss":6.5,"cvss-time":"2021-09-10T19:41:00","cvss-vector":"AV:N/AC:L/Au:S/C:P/I:P/A:P","cwe":"CWE-91","id":"CVE-2021-39181","impact":{"availability":"PARTIAL","confidentiality":"PARTIAL","integrity":"PARTIAL"},"last-modified":"2021-09-10T19:41:00","references":["https://github.com/OpenOLAT/OpenOLAT/commit/3f219ac457afde82e3be57bc614352ab92c05684","https://jira.openolat.org/browse/OO-5548","https://github.com/OpenOLAT/OpenOLAT/security/advisories/GHSA-596v-3gwh-2m9w"],"summary":"OpenOlat is a web-based learning management system (LMS). Prior to version 15.3.18, 15.5.3, and 16.0.0, using a prepared import XML file (e.g. a course) any class on the Java classpath can be instantiated, including spring AOP bean factories. This can be used to execute code arbitrary code by the attacker. The attack requires an OpenOlat user account with the authoring role. It can not be exploited by unregistered users. The problem is fixed in versions 15.3.18, 15.5.3, and 16.0.0. There are no known workarounds aside from upgrading.","vulnerable_configuration":[{"id":"cpe:2.3:a:frentix:openolat:-:*:*:*:*:*:*:*","title":"cpe:2.3:a:frentix:openolat:-:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:frentix:openolat:*:*:*:*:*:*:*:*","title":"cpe:2.3:a:frentix:openolat:*:*:*:*:*:*:*:*"}],"vulnerable_configuration_cpe_2_2":[],"vulnerable_product":["cpe:2.3:a:frentix:openolat:-:*:*:*:*:*:*:*","cpe:2.3:a:frentix:openolat:*:*:*:*:*:*:*:*"]}