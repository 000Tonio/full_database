{"Modified":"2021-06-10T13:32:00","Published":"2021-05-27T18:15:00","access":{"authentication":"NONE","complexity":"LOW","vector":"NETWORK"},"assigner":"security-advisories@github.com","capec":[{"id":"76","name":"Manipulating Web Input to File System Calls","prerequisites":"Program must allow for user controlled variables to be applied directly to the filesystem","related_weakness":["15","22","23","264","272","285","346","348","59","715","73","74","77"],"solutions":"Design: Enforce principle of least privilege. Design: Ensure all input is validated, and does not contain file system commands Design: Run server interfaces with a non-root account and/or utilize chroot jails or other configuration techniques to constrain privileges even if attacker gains some limited access to commands. Design: For interactive user applications, consider if direct file system interface is necessary, instead consider having the application proxy communication. Implementation: Perform testing such as pen-testing and vulnerability scanning to identify directories, programs, and interfaces that grant direct access to executables.","summary":"An attacker manipulates inputs to the target software which the target software passes to file system calls in the OS. The goal is to gain access to, and perhaps modify, areas of the file system that the target software did not intend to be accessible."},{"id":"64","name":"Using Slashes and URL Encoding Combined to Bypass Validation Logic","prerequisites":"The application accepts and decodes URL string request. The application performs insufficient filtering/canonicalization on the URLs.","related_weakness":["171","172","173","177","20","21","22","697","707","73","74"],"solutions":"Assume all input is malicious. Create a white list that defines all valid input to the software system based on the requirements specifications. Input that does not match against the white list should not be permitted to enter into the system. Test your decoding process against malicious input. Be aware of the threat of alternative method of data encoding and obfuscation technique such as IP address encoding. When client input is required from web-based forms, avoid using the \"GET\" method to submit data, as the method causes the form data to be appended to the URL and is easily manipulated. Instead, use the \"POST method whenever possible. Any security checks should occur after the data has been decoded and validated as correct data format. Do not repeat decoding process, if bad character are left after decoding process, treat the data as suspicious, and fail the validation process. Refer to the RFCs to safely decode URL. Regular expression can be used to match safe URL patterns. However, that may discard valid URL requests if the regular expression is too restrictive. There are tools to scan HTTP requests to the server for valid URL such as URLScan from Microsoft (http://www.microsoft.com/technet/security/tools/urlscan.mspx).","summary":"This attack targets the encoding of the URL combined with the encoding of the slash characters. An attacker can take advantage of the multiple ways of encoding a URL and abuse the interpretation of the URL. A URL may contain special character that need special syntax handling in order to be interpreted. Special characters are represented using a percentage character followed by two digits representing the octet code of the original character (%HEX-CODE). For instance US-ASCII space character would be represented with %20. This is often referred as escaped ending or percent-encoding. Since the server decodes the URL from the requests, it may restrict the access to some URL paths by validating and filtering out the URL requests it received. An attacker will try to craft an URL with a sequence of special characters which once interpreted by the server will be equivalent to a forbidden URL. It can be difficult to protect against this attack since the URL can contain other format of encoding such as UTF-8 encoding, Unicode-encoding, etc."},{"id":"78","name":"Using Escaped Slashes in Alternate Encoding","prerequisites":"The application accepts the backlash character as escape character. The application server does incomplete input data decoding, filtering and validation.","related_weakness":["171","172","173","180","181","20","21","22","697","707","73","74"],"solutions":"Verify that the user-supplied data does not use backslash character to escape malicious characters. Assume all input is malicious. Create a white list that defines all valid input to the software system based on the requirements specifications. Input that does not match against the white list should not be permitted to enter into the system. Be aware of the threat of alternative method of data encoding. Regular expressions can be used to filter out backslash. Make sure you decode before filtering and validating the untrusted input data. In the case of path traversals, use the principle of least privilege when determining access rights to file systems. Do not allow users to access directories/files that they should not access. Any security checks should occur after the data has been decoded and validated as correct data format. Do not repeat decoding process, if bad character are left after decoding process, treat the data as suspicious, and fail the validation process. Avoid making decisions based on names of resources (e.g. files) if those resources can have alternate names.","summary":"This attack targets the use of the backslash in alternate encoding. An attacker can provide a backslash as a leading character and causes a parser to believe that the next character is special. This is called an escape. By using that trick, the attacker tries to exploit alternate ways to encode the same character which leads to filter problems and opens avenues to attack."},{"id":"126","name":"Path Traversal","prerequisites":"The attacker must be able to control the path that is requested of the target. The target must fail to adequately sanitize incoming paths","related_weakness":["22"],"solutions":"Design: Configure the access control correctly. Design: Enforce principle of least privilege. Design: Execute programs with constrained privileges, so parent process does not open up further vulnerabilities. Ensure that all directories, temporary directories and files, and memory are executing with limited privileges to protect against remote execution. Design: Input validation. Assume that user inputs are malicious. Utilize strict type, character, and encoding enforcement. Design: Proxy communication to host, so that communications are terminated at the proxy, sanitizing the requests before forwarding to server host. Design: Run server interfaces with a non-root account and/or utilize chroot jails or other configuration techniques to constrain privileges even if attacker gains some limited access to commands. Implementation: Host integrity monitoring for critical files, directories, and processes. The goal of host integrity monitoring is to be aware when a security issue has occurred so that incident response and other forensic activities can begin. Implementation: Perform input validation for all remote content, including remote and user-generated content. Implementation: Perform testing such as pen-testing and vulnerability scanning to identify directories, programs, and interfaces that grant direct access to executables. Implementation: Use indirect references rather than actual file names. Implementation: Use possible permissions on file access when developing and deploying web applications. Implementation: Validate user input by only accepting known good. Ensure all content that is delivered to client is sanitized against an acceptable content specification -- whitelisting approach.","summary":"An adversary uses path manipulation methods to exploit insufficient input validation of a target to obtain access to data that should be not be retrievable by ordinary well-formed requests. A typical variety of this attack involves specifying a path to a desired file together with dot-dot-slash characters, resulting in the file access API or function traversing out of the intended directory structure and into the root file system. By replacing or modifying the expected path information the access function or API retrieves the file desired by the attacker. These attacks either involve the attacker providing a complete path to a targeted file or using control characters (e.g. path separators (/ or \\) and/or dots (.)) to reach desired directories or files."},{"id":"79","name":"Using Slashes in Alternate Encoding","prerequisites":"The application server accepts paths to locate resources. The application server does insufficient input data validation on the resource path requested by the user. The access right to resources are not set properly.","related_weakness":["171","173","180","181","185","20","200","21","22","697","707","73","74"],"solutions":"Any security checks should occur after the data has been decoded and validated as correct data format. Do not repeat decoding process, if bad character are left after decoding process, treat the data as suspicious, and fail the validation process. Refer to the RFCs to safely decode URL. When client input is required from web-based forms, avoid using the \"GET\" method to submit data, as the method causes the form data to be appended to the URL and is easily manipulated. Instead, use the \"POST method whenever possible. There are tools to scan HTTP requests to the server for valid URL such as URLScan from Microsoft (http://www.microsoft.com/technet/security/tools/urlscan.mspx) Be aware of the threat of alternative method of data encoding and obfuscation technique such as IP address encoding. (See related guideline section) Test your path decoding process against malicious input. In the case of path traversals, use the principle of least privilege when determining access rights to file systems. Do not allow users to access directories/files that they should not access. Assume all input is malicious. Create a white list that defines all valid input to the application based on the requirements specifications. Input that does not match against the white list should not be permitted to enter into the system.","summary":"This attack targets the encoding of the Slash characters. An attacker would try to exploit common filtering problems related to the use of the slashes characters to gain access to resources on the target host. Directory-driven systems, such as file systems and databases, typically use the slash character to indicate traversal between directories or other container components. For murky historical reasons, PCs (and, as a result, Microsoft OSs) choose to use a backslash, whereas the UNIX world typically makes use of the forward slash. The schizophrenic result is that many MS-based systems are required to understand both forms of the slash. This gives the attacker many opportunities to discover and abuse a number of common filtering problems. The goal of this pattern is to discover server software that only applies filters to one version, but not the other."}],"cvss":5,"cvss-time":"2021-06-10T13:32:00","cvss-vector":"AV:N/AC:L/Au:N/C:P/I:N/A:N","cwe":"CWE-22","id":"CVE-2021-32643","impact":{"availability":"NONE","confidentiality":"PARTIAL","integrity":"NONE"},"last-modified":"2021-06-10T13:32:00","references":["https://github.com/http4s/http4s/security/advisories/GHSA-6h7w-fc84-x7p6","https://github.com/http4s/http4s/commit/52e1890665410b4385e37b96bc49c5e3c708e4e9","https://mvnrepository.com/artifact/org.http4s/http4s-core"],"summary":"Http4s is a Scala interface for HTTP services. `StaticFile.fromUrl` can leak the presence of a directory on a server when the `URL` scheme is not `file://`, and the URL points to a fetchable resource under its scheme and authority. The function returns `F[None]`, indicating no resource, if `url.getFile` is a directory, without first checking the scheme or authority of the URL. If a URL connection to the scheme and URL would return a stream, and the path in the URL exists as a directory on the server, the presence of the directory on the server could be inferred from the 404 response. The contents and other metadata about the directory are not exposed. This affects http4s versions: 0.21.7 through 0.21.23, 0.22.0-M1 through 0.22.0-M8, 0.23.0-M1, and 1.0.0-M1 through 1.0.0-M22. The [patch](https://github.com/http4s/http4s/commit/52e1890665410b4385e37b96bc49c5e3c708e4e9) is available in the following versions: v0.21.24, v0.22.0-M9, v0.23.0-M2, v1.0.0-M23. As a workaround users can avoid calling `StaticFile.fromUrl` with non-file URLs.","vulnerable_configuration":[{"id":"cpe:2.3:a:typelevel:http4s:0.21.7:*:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.21.7:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.21.8:*:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.21.8:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.21.9:*:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.21.9:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.21.11:*:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.21.11:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.21.12:*:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.21.12:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.21.13:*:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.21.13:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.21.14:*:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.21.14:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.21.15:*:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.21.15:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.21.16:*:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.21.16:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.21.17:*:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.21.17:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.21.18:*:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.21.18:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.21.19:*:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.21.19:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.21.20:*:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.21.20:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.21.21:*:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.21.21:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.21.22:*:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.21.22:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.21.23:*:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.21.23:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.22.0:milestone1:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.22.0:milestone1:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.22.0:milestone2:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.22.0:milestone2:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.22.0:milestone3:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.22.0:milestone3:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.22.0:milestone4:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.22.0:milestone4:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.22.0:milestone5:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.22.0:milestone5:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.22.0:milestone6:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.22.0:milestone6:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.22.0:milestone7:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.22.0:milestone7:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.22.0:milestone8:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.22.0:milestone8:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:0.23.0:milestone1:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:0.23.0:milestone1:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone1:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone1:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone10:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone10:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone11:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone11:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone12:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone12:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone13:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone13:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone14:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone14:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone15:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone15:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone16:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone16:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone17:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone17:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone18:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone18:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone19:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone19:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone2:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone2:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone20:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone20:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone21:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone21:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone22:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone22:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone3:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone3:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone4:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone4:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone5:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone5:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone6:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone6:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone7:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone7:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone8:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone8:*:*:*:*:*:*"},{"id":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone9:*:*:*:*:*:*","title":"cpe:2.3:a:typelevel:http4s:1.0.0:milestone9:*:*:*:*:*:*"}],"vulnerable_configuration_cpe_2_2":[],"vulnerable_product":["cpe:2.3:a:typelevel:http4s:0.21.7:*:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.21.8:*:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.21.9:*:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.21.11:*:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.21.12:*:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.21.13:*:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.21.14:*:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.21.15:*:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.21.16:*:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.21.17:*:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.21.18:*:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.21.19:*:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.21.20:*:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.21.21:*:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.21.22:*:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.21.23:*:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.22.0:milestone1:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.22.0:milestone2:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.22.0:milestone3:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.22.0:milestone4:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.22.0:milestone5:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.22.0:milestone6:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.22.0:milestone7:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.22.0:milestone8:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:0.23.0:milestone1:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:1.0.0:milestone1:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:1.0.0:milestone10:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:1.0.0:milestone11:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:1.0.0:milestone12:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:1.0.0:milestone13:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:1.0.0:milestone14:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:1.0.0:milestone15:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:1.0.0:milestone16:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:1.0.0:milestone17:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:1.0.0:milestone18:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:1.0.0:milestone19:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:1.0.0:milestone2:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:1.0.0:milestone20:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:1.0.0:milestone21:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:1.0.0:milestone22:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:1.0.0:milestone3:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:1.0.0:milestone4:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:1.0.0:milestone5:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:1.0.0:milestone6:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:1.0.0:milestone7:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:1.0.0:milestone8:*:*:*:*:*:*","cpe:2.3:a:typelevel:http4s:1.0.0:milestone9:*:*:*:*:*:*"]}