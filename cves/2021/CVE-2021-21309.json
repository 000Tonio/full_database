{"Modified":"2022-10-19T13:21:00","Published":"2021-02-26T22:15:00","access":{"authentication":"SINGLE","complexity":"LOW","vector":"NETWORK"},"assigner":"security-advisories@github.com","capec":[{"id":"92","name":"Forced Integer Overflow","prerequisites":"The attacker can manipulate the value of an integer variable utilized by the target host. The target host does not do proper range checking on the variable before utilizing it. When the integer variable is incremented or decremented to an out of range value, it gets a very different value (e.g. very small or negative number)","related_weakness":["120","122","128","190","196","680","697"],"solutions":"Use a language or compiler that performs automatic bounds checking. Carefully review the service's implementation before making it available to user. For instance you can use manual or automated code review to uncover vulnerabilities such as integer overflow. Use an abstraction library to abstract away risky APIs. Not a complete solution. Always do bound checking before consuming user input data.","summary":"This attack forces an integer variable to go out of range. The integer variable is often used as an offset such as size of memory allocation or similarly. The attacker would typically control the value of such variable and try to get it out of range. For instance the integer in question is incremented past the maximum possible value, it may wrap to become a very small, or negative number, therefore providing a very incorrect value which can lead to unexpected behavior. At worst the attacker can execute arbitrary code."}],"cvss":6.5,"cvss-time":"2022-10-19T13:21:00","cvss-vector":"AV:N/AC:L/Au:S/C:P/I:P/A:P","cwe":"CWE-190","id":"CVE-2021-21309","impact":{"availability":"PARTIAL","confidentiality":"PARTIAL","integrity":"PARTIAL"},"last-modified":"2022-10-19T13:21:00","references":["https://github.com/redis/redis/commit/c992857618db99776917f10bf4f2345a5fdc78b0","https://github.com/redis/redis/security/advisories/GHSA-hgj8-vff2-7cjf","https://github.com/redis/redis/pull/8522","https://security.gentoo.org/glsa/202103-02"],"summary":"Redis is an open-source, in-memory database that persists on disk. In affected versions of Redis an integer overflow bug in 32-bit Redis version 4.0 or newer could be exploited to corrupt the heap and potentially result with remote code execution. Redis 4.0 or newer uses a configurable limit for the maximum supported bulk input size. By default, it is 512MB which is a safe value for all platforms. If the limit is significantly increased, receiving a large request from a client may trigger several integer overflow scenarios, which would result with buffer overflow and heap corruption. We believe this could in certain conditions be exploited for remote code execution. By default, authenticated Redis users have access to all configuration parameters and can therefore use the “CONFIG SET proto-max-bulk-len” to change the safe default, making the system vulnerable. **This problem only affects 32-bit Redis (on a 32-bit system, or as a 32-bit executable running on a 64-bit system).** The problem is fixed in version 6.2, and the fix is back ported to 6.0.11 and 5.0.11. Make sure you use one of these versions if you are running 32-bit Redis. An additional workaround to mitigate the problem without patching the redis-server executable is to prevent clients from directly executing `CONFIG SET`: Using Redis 6.0 or newer, ACL configuration can be used to block the command. Using older versions, the `rename-command` configuration directive can be used to rename the command to a random string unknown to users, rendering it inaccessible. Please note that this workaround may have an additional impact on users or operational systems that expect `CONFIG SET` to behave in certain ways.","vulnerable_configuration":[{"id":"cpe:2.3:a:redislabs:redis:6.0.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:6.0.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:6.0.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:6.0.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:6.0.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:6.0.2:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:6.0.3:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:6.0.3:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:6.0.4:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:6.0.4:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:6.0.5:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:6.0.5:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:6.0.6:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:6.0.6:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:6.0.7:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:6.0.7:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:6.0.8:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:6.0.8:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:6.0.9:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:6.0.9:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:6.0.10:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:6.0.10:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:4.0:-:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:4.0:-:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:4.0:rc1:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:4.0:rc1:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:4.0:rc3:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:4.0:rc3:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:4.0.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:4.0.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:4.0.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:4.0.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:4.0.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:4.0.2:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:4.0.3:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:4.0.3:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:4.0.4:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:4.0.4:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:4.0.5:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:4.0.5:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:4.0.6:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:4.0.6:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:4.0.7:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:4.0.7:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:4.0.8:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:4.0.8:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:4.0.9:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:4.0.9:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:4.0.10:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:4.0.10:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:4.0.11:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:4.0.11:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:4.0.12:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:4.0.12:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:4.0.13:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:4.0.13:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:4.0.14:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:4.0.14:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:5.0:-:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:5.0:-:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:5.0:rc1:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:5.0:rc1:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:5.0:rc2:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:5.0:rc2:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:5.0:rc3:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:5.0:rc3:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:5.0:rc4:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:5.0:rc4:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:5.0:rc5:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:5.0:rc5:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:5.0:rc6:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:5.0:rc6:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:5.0.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:5.0.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:5.0.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:5.0.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:5.0.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:5.0.2:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:5.0.3:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:5.0.3:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:5.0.4:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:5.0.4:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:5.0.5:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:5.0.5:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:5.0.6:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:5.0.6:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:5.0.7:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:5.0.7:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:5.0.8:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:5.0.8:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:5.0.9:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:5.0.9:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:redislabs:redis:5.0.10:*:*:*:*:*:*:*","title":"cpe:2.3:a:redislabs:redis:5.0.10:*:*:*:*:*:*:*"}],"vulnerable_configuration_cpe_2_2":[],"vulnerable_product":["cpe:2.3:a:redislabs:redis:6.0.0:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:6.0.1:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:6.0.2:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:6.0.3:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:6.0.4:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:6.0.5:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:6.0.6:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:6.0.7:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:6.0.8:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:6.0.9:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:6.0.10:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:4.0:-:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:4.0:rc1:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:4.0:rc3:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:4.0.0:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:4.0.1:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:4.0.2:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:4.0.3:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:4.0.4:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:4.0.5:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:4.0.6:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:4.0.7:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:4.0.8:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:4.0.9:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:4.0.10:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:4.0.11:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:4.0.12:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:4.0.13:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:4.0.14:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:5.0:-:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:5.0:rc1:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:5.0:rc2:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:5.0:rc3:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:5.0:rc4:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:5.0:rc5:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:5.0:rc6:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:5.0.0:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:5.0.1:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:5.0.2:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:5.0.3:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:5.0.4:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:5.0.5:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:5.0.6:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:5.0.7:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:5.0.8:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:5.0.9:*:*:*:*:*:*:*","cpe:2.3:a:redislabs:redis:5.0.10:*:*:*:*:*:*:*"]}