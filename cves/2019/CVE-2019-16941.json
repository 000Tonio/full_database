{"Modified":"2019-10-04T21:15:00","Published":"2019-09-28T16:15:00","access":{"authentication":"NONE","complexity":"MEDIUM","vector":"NETWORK"},"assigner":"cve@mitre.org","capec":[{"id":"83","name":"XPath Injection","prerequisites":"XPath queries used to retrieve information stored in XML documents User-controllable input not properly sanitized before being used as part of XPath queries","related_weakness":["20","707","713","74","91"],"solutions":"Strong input validation - All user-controllable input must be validated and filtered for illegal characters as well as content that can be interpreted in the context of an XPath expression. Characters such as a single-quote(') or operators such as or (|), and (&) and such should be filtered if the application does not expect them in the context in which they appear. If such content cannot be filtered, it must at least be properly escaped to avoid them being interpreted as part of XPath expressions. Use of parameterized XPath queries - Parameterization causes the input to be restricted to certain domains, such as strings or integers, and any input outside such domains is considered invalid and the query fails. Use of custom error pages - Attackers can glean information about the nature of queries from descriptive error messages. Input validation must be coupled with customized error pages that inform about an error without disclosing information about the database or application.","summary":"An attacker can craft special user-controllable input consisting of XPath expressions to inject the XML database and bypass authentication or glean information that he normally would not be able to. XPath Injection enables an attacker to talk directly to the XML database, thus bypassing the application completely. XPath Injection results from the failure of an application to properly sanitize input used as part of dynamic XPath expressions used to query an XML database."},{"id":"250","name":"XML Injection","prerequisites":"XML queries used to process user input and retrieve information stored in XML documents User-controllable input not properly sanitized","related_weakness":["20","707","713","74","91"],"solutions":"Use of custom error pages - Attackers can glean information about the nature of queries from descriptive error messages. Input validation must be coupled with customized error pages that inform about an error without disclosing information about the database or application.","summary":"An attacker utilizes crafted XML user-controllable input to probe, attack, and inject data into the XML database, using techniques similar to SQL injection. The user-controllable input can allow for unauthorized viewing of data, bypassing authentication or the front-end application for direct XML database access, and possibly altering database information."}],"cvss":6.8,"cvss-time":"2019-10-04T21:15:00","cvss-vector":"AV:N/AC:M/Au:N/C:P/I:P/A:P","cwe":"CWE-91","id":"CVE-2019-16941","impact":{"availability":"PARTIAL","confidentiality":"PARTIAL","integrity":"PARTIAL"},"last-modified":"2019-10-04T21:15:00","references":["https://github.com/NationalSecurityAgency/ghidra/blob/79d8f164f8bb8b15cfb60c5d4faeb8e1c25d15ca/Ghidra/Features/BytePatterns/src/main/java/ghidra/bitpatterns/info/FileBitPatternInfoReader.java#L187-L188","https://github.com/NationalSecurityAgency/ghidra/commit/a17728f8c12effa171b17a25ccfb7e7d9528c5d0","https://github.com/NationalSecurityAgency/ghidra/issues/1090","https://github.com/purpleracc00n/CVE-2019-16941","https://twitter.com/NSAGov/status/1178812792159248385","https://www.symantec.com/security-center/vulnerabilities/writeup/110223?om_rssid=sr-advisories"],"refmap":{"misc":["https://github.com/NationalSecurityAgency/ghidra/blob/79d8f164f8bb8b15cfb60c5d4faeb8e1c25d15ca/Ghidra/Features/BytePatterns/src/main/java/ghidra/bitpatterns/info/FileBitPatternInfoReader.java#L187-L188","https://github.com/NationalSecurityAgency/ghidra/commit/a17728f8c12effa171b17a25ccfb7e7d9528c5d0","https://github.com/NationalSecurityAgency/ghidra/issues/1090","https://github.com/purpleracc00n/CVE-2019-16941","https://twitter.com/NSAGov/status/1178812792159248385","https://www.symantec.com/security-center/vulnerabilities/writeup/110223?om_rssid=sr-advisories"]},"summary":"NSA Ghidra through 9.0.4, when experimental mode is enabled, allows arbitrary code execution if the Read XML Files feature of Bit Patterns Explorer is used with a modified XML document. This occurs in Features/BytePatterns/src/main/java/ghidra/bitpatterns/info/FileBitPatternInfoReader.java. An attack could start with an XML document that was originally created by DumpFunctionPatternInfoScript but then directly modified by an attacker (for example, to make a java.lang.Runtime.exec call).","vulnerable_configuration":[{"id":"cpe:2.3:a:nsa:ghidra:9.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:nsa:ghidra:9.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:nsa:ghidra:9.0.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:nsa:ghidra:9.0.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:nsa:ghidra:9.0.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:nsa:ghidra:9.0.2:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:nsa:ghidra:9.0.3:*:*:*:*:*:*:*","title":"cpe:2.3:a:nsa:ghidra:9.0.3:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:nsa:ghidra:9.0.4:*:*:*:*:*:*:*","title":"cpe:2.3:a:nsa:ghidra:9.0.4:*:*:*:*:*:*:*"}],"vulnerable_configuration_cpe_2_2":[],"vulnerable_product":["cpe:2.3:a:nsa:ghidra:9.0:*:*:*:*:*:*:*","cpe:2.3:a:nsa:ghidra:9.0.1:*:*:*:*:*:*:*","cpe:2.3:a:nsa:ghidra:9.0.2:*:*:*:*:*:*:*","cpe:2.3:a:nsa:ghidra:9.0.3:*:*:*:*:*:*:*","cpe:2.3:a:nsa:ghidra:9.0.4:*:*:*:*:*:*:*"]}