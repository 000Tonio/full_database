{"Modified":"2019-11-08T17:27:00","Published":"2019-11-05T14:15:00","access":{"authentication":"NONE","complexity":"LOW","vector":"NETWORK"},"assigner":"cve@mitre.org","capec":[{"id":"509","name":"Kerberoasting","prerequisites":"The adversary requires access as an authenticated user on the system. This attack pattern relates to elevating privileges. The adversary requires use of a third-party credential harvesting tool (e.g., Mimikatz). The adversary requires a brute force tool.","related_weakness":["552"],"solutions":"Monitor system and domain logs for abnormal access. Employ a robust password policy for service accounts. Passwords should be of adequate length and complexity, and they should expire after a period of time. Employ the principle of least privilege: limit service accounts privileges to what is required for functionality and no more. Enable AES Kerberos encryption (or another stronger encryption algorithm), rather than RC4, where possible.","summary":"Through the exploitation of how service accounts leverage Kerberos authentication with Service Principal Names (SPNs), the adversary obtains and subsequently cracks the hashed credentials of a service account target to exploit its privileges. The Kerberos authentication protocol centers around a ticketing system which is used to request/grant access to services and to then access the requested services. As an authenticated user, the adversary may request Active Directory and obtain a service ticket with portions encrypted via RC4 with the private key of the authenticated account. By extracting the local ticket and saving it disk, the adversary can brute force the hashed value to reveal the target account credentials."},{"id":"639","name":"Probe System Files","prerequisites":"An adversary has access to the file system of a system.","related_weakness":["552"],"solutions":"Verify that files have proper access controls set, and reduce the storage of sensitive information to only what is necessary.","summary":"An adversary obtains unauthorized information due to improperly protected files. If an application stores sensitive information in a file that is not protected by proper access control, then an adversary can access the file and search for sensitive information."},{"id":"150","name":"Collect Data from Common Resource Locations","prerequisites":"The targeted applications must either expect files to be located at a specific location or, if the location of the files can be configured by the user, the user either failed to move the files from the default location or placed them in a conventional location for files of the given type.","related_weakness":["552"],"solutions":"","summary":"An adversary exploits well-known locations for resources for the purposes of undermining the security of the target. In many, if not most systems, files and resources are organized in a default tree structure. This can be useful for adversaries because they often know where to look for resources or files that are necessary for attacks. Even when the precise location of a targeted resource may not be known, naming conventions may indicate a small area of the target machine's file tree where the resources are typically located. For example, configuration files are normally stored in the /etc director on Unix systems. Adversaries can take advantage of this to commit other types of attacks."}],"cvss":5,"cvss-time":"2019-11-08T17:27:00","cvss-vector":"AV:N/AC:L/Au:N/C:P/I:N/A:N","cwe":"CWE-552","id":"CVE-2019-17221","impact":{"availability":"NONE","confidentiality":"PARTIAL","integrity":"NONE"},"last-modified":"2019-11-08T17:27:00","references":["https://www.darkmatter.ae/blogs/breaching-the-perimeter-phantomjs-arbitrary-file-read/"],"refmap":{"misc":["https://www.darkmatter.ae/blogs/breaching-the-perimeter-phantomjs-arbitrary-file-read/"]},"summary":"PhantomJS through 2.1.1 has an arbitrary file read vulnerability, as demonstrated by an XMLHttpRequest for a file:// URI. The vulnerability exists in the page.open() function of the webpage module, which loads a specified URL and calls a given callback. An attacker can supply a specially crafted HTML file, as user input, that allows reading arbitrary files on the filesystem. For example, if page.render() is the function callback, this generates a PDF or an image of the targeted file. NOTE: this product is no longer developed.","vulnerable_configuration":[{"id":"cpe:2.3:a:phantomjs:phantomjs:1.0.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:1.0.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:phantomjs:phantomjs:1.1.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:1.1.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:phantomjs:phantomjs:1.2.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:1.2.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:phantomjs:phantomjs:1.3.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:1.3.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:phantomjs:phantomjs:1.4.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:1.4.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:phantomjs:phantomjs:1.4.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:1.4.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:phantomjs:phantomjs:1.5.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:1.5.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:phantomjs:phantomjs:1.6.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:1.6.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:phantomjs:phantomjs:1.6.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:1.6.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:phantomjs:phantomjs:1.7.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:1.7.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:phantomjs:phantomjs:1.8.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:1.8.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:phantomjs:phantomjs:1.8.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:1.8.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:phantomjs:phantomjs:1.8.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:1.8.2:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:phantomjs:phantomjs:1.9.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:1.9.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:phantomjs:phantomjs:1.9.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:1.9.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:phantomjs:phantomjs:1.9.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:1.9.2:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:phantomjs:phantomjs:1.9.3:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:1.9.3:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:phantomjs:phantomjs:1.9.6:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:1.9.6:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:phantomjs:phantomjs:1.9.7:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:1.9.7:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:phantomjs:phantomjs:1.9.8:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:1.9.8:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:phantomjs:phantomjs:2.0.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:2.0.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:phantomjs:phantomjs:2.1.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:2.1.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:phantomjs:phantomjs:2.1.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:phantomjs:phantomjs:2.1.1:*:*:*:*:*:*:*"}],"vulnerable_configuration_cpe_2_2":[],"vulnerable_product":["cpe:2.3:a:phantomjs:phantomjs:1.0.0:*:*:*:*:*:*:*","cpe:2.3:a:phantomjs:phantomjs:1.1.0:*:*:*:*:*:*:*","cpe:2.3:a:phantomjs:phantomjs:1.2.0:*:*:*:*:*:*:*","cpe:2.3:a:phantomjs:phantomjs:1.3.0:*:*:*:*:*:*:*","cpe:2.3:a:phantomjs:phantomjs:1.4.0:*:*:*:*:*:*:*","cpe:2.3:a:phantomjs:phantomjs:1.4.1:*:*:*:*:*:*:*","cpe:2.3:a:phantomjs:phantomjs:1.5.0:*:*:*:*:*:*:*","cpe:2.3:a:phantomjs:phantomjs:1.6.0:*:*:*:*:*:*:*","cpe:2.3:a:phantomjs:phantomjs:1.6.1:*:*:*:*:*:*:*","cpe:2.3:a:phantomjs:phantomjs:1.7.0:*:*:*:*:*:*:*","cpe:2.3:a:phantomjs:phantomjs:1.8.0:*:*:*:*:*:*:*","cpe:2.3:a:phantomjs:phantomjs:1.8.1:*:*:*:*:*:*:*","cpe:2.3:a:phantomjs:phantomjs:1.8.2:*:*:*:*:*:*:*","cpe:2.3:a:phantomjs:phantomjs:1.9.0:*:*:*:*:*:*:*","cpe:2.3:a:phantomjs:phantomjs:1.9.1:*:*:*:*:*:*:*","cpe:2.3:a:phantomjs:phantomjs:1.9.2:*:*:*:*:*:*:*","cpe:2.3:a:phantomjs:phantomjs:1.9.3:*:*:*:*:*:*:*","cpe:2.3:a:phantomjs:phantomjs:1.9.6:*:*:*:*:*:*:*","cpe:2.3:a:phantomjs:phantomjs:1.9.7:*:*:*:*:*:*:*","cpe:2.3:a:phantomjs:phantomjs:1.9.8:*:*:*:*:*:*:*","cpe:2.3:a:phantomjs:phantomjs:2.0.0:*:*:*:*:*:*:*","cpe:2.3:a:phantomjs:phantomjs:2.1.0:*:*:*:*:*:*:*","cpe:2.3:a:phantomjs:phantomjs:2.1.1:*:*:*:*:*:*:*"]}